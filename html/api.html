<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5.dev">
<meta name="author" content="TabaTa LLC">
<title>TbT API</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-right">
<div id="header">
<h1>TbT API</h1>
<div class="details">
<span id="author" class="author">TabaTa LLC</span><br>
<span id="email" class="email"><a href="mailto:info@tbt-post.net">info@tbt-post.net</a></span><br>
<span id="revnumber">version 1.3.2,</span>
<span id="revdate">2018-11-01 (1</span>
<br><span id="revremark">1.3.2): Public API</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#true-">Общая информация</a>
<ul class="sectlevel2">
<li><a href="#true--2">Форматы протокола</a></li>
<li><a href="#true--3">Типы данных</a></li>
<li><a href="#truehttp">HTTP Методы</a></li>
<li><a href="#truehttp-2">HTTP Статусы</a></li>
</ul>
</li>
<li><a href="#trueapi">API</a>
<ul class="sectlevel2">
<li><a href="#true--4">Регистрация</a>
<ul class="sectlevel3">
<li><a href="#true--5">Создание пользователя</a></li>
<li><a href="#true--6">Создание пользователя оператором</a></li>
<li><a href="#true--7">Потдтверждение регистрации</a>
<ul class="sectlevel4">
<li><a href="#true--8">Запрос ОТС</a></li>
<li><a href="#true--9">Подтверждение</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#true--10">Вход</a></li>
<li><a href="#true--11">Выход</a></li>
<li><a href="#true--12">Восстановление пароля</a>
<ul class="sectlevel3">
<li><a href="#true--13">Запрос ОТС</a></li>
<li><a href="#true--14">Превалидация ОТС</a></li>
<li><a href="#true--15">Изменение пароля</a></li>
</ul>
</li>
<li><a href="#true--16">Изменение пароля</a></li>
<li><a href="#true--17">Пользовательский профиль</a>
<ul class="sectlevel3">
<li><a href="#true--18">Получение собственного профиля</a></li>
<li><a href="#true--19">Обновление собственного профиля</a></li>
<li><a href="#true--20">Получение базовых данных пользователя</a></li>
<li><a href="#true--21">Получение базовых данных списка пользователей</a></li>
<li><a href="#true--22">Получение профиля пользователя</a></li>
<li><a href="#true--23">Обновление профиля пользователя</a></li>
<li><a href="#true--24">Подтверждение профиля пользователя оператором</a></li>
<li><a href="#true-id">Получение списка пользователей по id</a></li>
<li><a href="#true--25">Поиск пользователей</a></li>
</ul>
</li>
<li><a href="#true--26">Вход по номеру телефона</a>
<ul class="sectlevel3">
<li><a href="#true--27">Запрос кода</a></li>
<li><a href="#true--28">Авторизация</a></li>
</ul>
</li>
<li><a href="#true--29">Изменение телефона</a>
<ul class="sectlevel3">
<li><a href="#true--30">Запрос ОТС</a></li>
<li><a href="#true--31">Подтверждение</a></li>
</ul>
</li>
<li><a href="#true-email">Изменение email</a>
<ul class="sectlevel3">
<li><a href="#true--32">Запрос ОТС</a></li>
<li><a href="#true--33">Подтверждение</a></li>
</ul>
</li>
<li><a href="#trueacl">ACL</a>
<ul class="sectlevel3">
<li><a href="#true--34">Роли пользоватлея</a></li>
</ul>
</li>
<li><a href="#true--35">Посылки</a>
<ul class="sectlevel3">
<li><a href="#true-id-code">Получение по id/code</a></li>
<li><a href="#true--36">Получение графических кодов</a></li>
<li><a href="#true--37">Поиск</a></li>
<li><a href="#true-id-2">Получение посылок по списку id</a></li>
<li><a href="#truec">Cписок посылок пользователя</a></li>
<li><a href="#true--38">Создание посылки</a></li>
<li><a href="#true--39">Изменение посылки</a></li>
<li><a href="#true--40">Статистика по посылкам для отделения</a></li>
<li><a href="#true--41">Сгруппированный список посылок для отделения</a></li>
<li><a href="#true--42">Статистика по посылкам для пользователя</a></li>
<li><a href="#true--43">Трекинговая информация о пользовательских посылках</a></li>
</ul>
</li>
<li><a href="#true--44">Адреса и отделения</a>
<ul class="sectlevel3">
<li><a href="#true--45">Получения данных отделений</a></li>
<li><a href="#true--46">Список адресов отделений</a></li>
<li><a href="#true--47">Получение адреса из справочника</a></li>
<li><a href="#true--48">Получение списка фильтров (агрегации) адресов</a></li>
<li><a href="#true--49">Создание адреса в справочнике</a></li>
<li><a href="#true--50">Список пользовательских адресов</a></li>
<li><a href="#true--51">Добавление пользовательского адреса</a></li>
<li><a href="#true--52">Список пользовательских адресов произвольного пользователя</a></li>
<li><a href="#true--53">Добавление пользовательского адреса произвольного пользователя</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#true--54">Сущности и справочники</a>
<ul class="sectlevel2">
<li><a href="#true--55">Ресурсы отделения</a>
<ul class="sectlevel3">
<li><a href="#truec-2">Cоздание ресурса отеления</a></li>
<li><a href="#true--56">Изменение ресурса отеления</a></li>
<li><a href="#true--57">Удаление ресурса отеления</a></li>
<li><a href="#true--58">Получение описания ресурса</a></li>
<li><a href="#true--59">Получение списка ресурсов</a></li>
<li><a href="#true-e">Пeреназначение иерархии для ресурса отделения</a></li>
</ul>
</li>
<li><a href="#true--60">Словари</a>
<ul class="sectlevel3">
<li><a href="#true--61">Сообщения для состояний отправлений</a></li>
<li><a href="#true--62">Словарь сервисов отделения</a></li>
<li><a href="#true--63">Сообщения для действий по отправлениям</a></li>
</ul>
</li>
<li><a href="#true-batch">Множественная (batch) обработка действий</a></li>
</ul>
</li>
<li><a href="#true--64">Уведомления</a>
<ul class="sectlevel2">
<li><a href="#true--65">Отчет интерфейса оператора</a></li>
<li><a href="#true--66">Клиент&#8594;Система</a>
<ul class="sectlevel3">
<li><a href="#true--67">Забор отправления в отделении</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true-"><a class="anchor" href="#true-"></a>Общая информация</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Доступ к API осуществляется:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>из всех мест <em>вне</em> локальной инфраструктуры - по протоколу HTTPS</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Внешний доступ к текущему апи&#8201;&#8212;&#8201;<a href="https://api.tbt-post.net" class="bare">https://api.tbt-post.net</a></p>
</div>
<div class="paragraph">
<p>Следующая версия апи&#8201;&#8212;&#8201;<a href="http://api-next.tbt-post.net" class="bare">http://api-next.tbt-post.net</a></p>
</div>
<div class="paragraph">
<p>Версия для разработки&#8201;&#8212;&#8201;<a href="http://sandbox-api.tbt-post.net" class="bare">http://sandbox-api.tbt-post.net</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если явно не указаного обратного, по-умолчанию формат данных (content-type) подразумевается как <code>application/json</code>, кодировка (encoding/charset) UTF-8, использование BOM (ByteOrderMark для Windows клиентов) - отключено.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если явно не указано обратного, текстовые поля в структурах данных (как ключи, так и значения)&#8201;&#8212;&#8201;чувствительны к регистру (case sensitive)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Формат URI для доступа к API:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>https://api.tbt-post.net/api/v{v_number}/{method_name}/{method_params}?{get_params}</pre>
</div>
</div>
<div class="paragraph">
<p>где:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
{v_number}
</td>
<td class="hdlist2">
<p>номер версии API в виде числа</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{method_name}
</td>
<td class="hdlist2">
<p>название метода</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{method_params}
</td>
<td class="hdlist2">
<p>параметры метода в URI</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{get_params}
</td>
<td class="hdlist2">
<p>опциональные параметры для метода/обработчика</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Также, в описании API используются:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
{protocol_method}
</td>
<td class="hdlist2">
<p>HTTP метод</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{request_body}
</td>
<td class="hdlist2">
<p>описание формата тела запроса</p>
</td>
</tr>
<tr>
<td class="hdlist1">
{expected_result}
</td>
<td class="hdlist2">
<p>описание формата возвращаемого в случае успеха результата в формате <code>&lt;Code&gt; &lt;Response body&gt;</code></p>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="true--2"><a class="anchor" href="#true--2"></a>Форматы протокола</h3>
<div class="paragraph">
<p>Формат обмена данными:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JSON - комплекскные формы и структуры данных</p>
</li>
<li>
<p>LINK PARAMS - параметризированный URI</p>
</li>
<li>
<p>REQUEST BODY - для передачи бинарных банных</p>
</li>
<li>
<p>REQUEST HEADER - для передачи заголовочной информации</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Формат возвращаемого ответа:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HTTP Response Code + JSON payload</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--3"><a class="anchor" href="#true--3"></a>Типы данных</h3>
<div class="paragraph">
<p>Для унификации работы с данными в различных использованных наборах
инструментов приняты такие типы данных и таковая их трактовка:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 1. Типы данных</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">#</th>
<th class="tableblock halign-left valign-top">Название типа</th>
<th class="tableblock halign-left valign-top">Описание типа</th>
<th class="tableblock halign-left valign-top">Пример</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Целое число длиной 4 байта (32 бита)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123456</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Целое число длиной 8 байт (64 бита)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123456890</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Вещественное число с разделителем "." длиной 8 байт (64 бита)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123456890.12 0.12345</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string (text)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Строка в формате unicode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">u'строка'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">datatime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Дата и время в формате ISO 8601 (UTC+0) YYYY-MM-DDTHH:MM:SSZ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2016-02-29T06:12:20Z</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Логический тип</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number/BigInteger</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Целое число длиной более 8 байт (&gt;64 бит)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">174554483551928087757411873995522791996L</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uuid (UUID)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Universally Unique Identifier&#8201;&#8212;&#8201;16-байтный (128-битный) номер, передается в текстовой форме как hexadecimal representation в виде строки, в бинарной форме&#8201;&#8212;&#8201;как Number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">u'8351f87e-7b89-4503-bc9a-76add66f5a3c' 174554483551928087757411873995522791996L</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Система использует форматы <code>UUID</code> версий <code>v0</code>,<code>v1</code>,<code>v2</code> и <code>v4</code> (форматы <code>v3</code> и <code>v5</code> поддерживаются, но не используются)
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
В случае явного указания в API и/или протоколе версии для типа <code>UUID</code>, подразумевается использование исключительно указанной версии
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Для хранения меток времени <code>created_at</code>,<code>modified_at</code> и т.п. используется <a href="https://tools.ietf.org/html/rfc4122#section-4.2.2">uuid версии 1</a></p>
</div>
</div>
<div class="sect2">
<h3 id="truehttp"><a class="anchor" href="#truehttp"></a>HTTP Методы</h3>
<div class="paragraph">
<p>При работе с API используются следующие HTTP методы для выполнения той или иной функции:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 2. Методы протокола</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">#</th>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Выборка данных, немодифицирующие запросы</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Создание данных</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Обновление данных</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Удаление данных</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="truehttp-2"><a class="anchor" href="#truehttp-2"></a>HTTP Статусы</h3>
<div class="paragraph">
<p>Возвращаемые методами статусы должны следовать стандартам HTTP протокола в
соответствии с
<a href="http://www.ietf.org/assignments/http-status-codes/http-status-codes.xml">IETF RFC7231</a></p>
</div>
<div class="paragraph">
<p>Основные используемые в системе коды приведены ниже:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 3. Статусы протокола</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Code</th>
<th class="tableblock halign-left valign-top">Значение</th>
<th class="tableblock halign-left valign-top">Описание</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Запрос выполнен успешно.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">201</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Created</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Запрос был выполнен, и, в результате, создан новый ресурс. Вновь созданный ресурс может быть, на который ссылается URI (ы) возвращается в объекте ответа, с самым конкретным URI для ресурса отдается в поле заголовка Location. Ответ СЛЕДУЕТ включить объект, содержащий список характеристик и местоположения (ы), из которых пользователь или агент пользователя может выбрать наиболее подходящий. Формат объекта определяется тип носителя приведены в Content-Type заголовка поля. Первоначальный сервер ДОЛЖЕН создать ресурс перед возвратом кода состояния 201. Если действие не может быть выполнено немедленно, сервер должен ответить 202 (Принято) вместо ответа.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">202</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Accepted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Запрос принят в обработку, но еще не завершен. Нет никаких гарантий, что запрос успешно выполнится в процессе обработки данных. Из-за асинхронного типа выполняемой операции отсутствует возможность повторной отправки статуса.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No Content</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Запрос был успешно обработан, но нет необходимости возвращать какие-либо данные. Так же в ответе может возвращаться новая, или обновленная информация, однако в итоге она не будет отличаться о того, что было изначально послано на сервер и, таким образом, считается что клиент и так обладает актуальной информацией.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">301</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moved Permanently</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Запрашиваемому ресурсу был установлен новый URI и будущие обращения к этому ресурсу должны осуществляться по возвращенному URI. Клиенты с возможностью редактирования должны автоматически переопределить ссылки на Request-URI для одной или более новых ссылок, возвращенных сервером, где это возможно. Этот ответ является кэшируемы если не указано иное.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">304</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Modified</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Если клиент выполнил условный запрос GET и доступ разрешен, но документ не был изменен, сервер должен ответить, используя этот код состояния.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bad Request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Запрос не удалось обработать из-за синтаксической ошибки или ошибки протокола</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">401</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Unauthorized</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Запрос требует аутентификации пользователя. Ответ должен содердать WWW-Authenticate заголовок (раздел 14.47). Клиент может повторить запрос с корректным Authorization заголовком (раздел 14.8). Если запрос уже содержит информацию для авторизации, в таком случае 401 код ответа показывает, что авторизация была отклонена.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">403</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forbidden</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сервер понял запрос, но отказывается его обрабатывать. Авторизация не поможет и этот запрос НЕ СЛЕДУЕТ повторять.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Found</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сервер не нашел по указанному URI никаких ресурсов. Нет никаких указаний о том, постоянное это состояние или нет. СЛЕДУЕТ использовать статус 410 (Gone), если серверу известно, что старый ресурс недоступен постоянно и у него нет адреса пересылки.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">409</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Conflict</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Запрос нельзя обработать из-за конфликта в текущем состоянии ресурса. Этот код разрешается использовать только в тех случаях, когда ожидается, что пользователь может самостоятельно разрешить этот конфликт и повторить запрос.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">410</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Требуемый ресурс больше не доступен на сервере и адрес его расположения не известен. Предполагается, что это состояние постоянно. Клиентам с возможностью редактирования ссылки СЛЕДУЕТ удалить ссылки на запрошенный URL после подтверждения</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">422</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unprocessable Entity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сервер понимает указанный вид данных, (т.е., статус 415 использовать нельзя), синтаксис запроса корректен (т.е. статус 400 использовать некорректно), однако содержащиеся в запросе инструкции нельзя выполнить ( Например, тело запроса синтаксически правильно, но содержит семантическую ошибку или некорректно обрабатывается нижним уровнем БД)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">429</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Too Many Requests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Возвращается баллансировщикам (т.е. исключительно внутренним/доверенным сервисам) в случае, когда сервис может самостоятельно оценить превышение нагрузки. В случае с внешними клиентами&#8201;&#8212;&#8201;задача оценки потока и <strong>блокирования</strong> трафика&#8201;&#8212;&#8201;целиком и полностью задача внешнего периметра системы. Т.о. данных статус&#8201;&#8212;&#8201;исключительно вспомогателен и должен использоваться с аккуратностью.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal Server Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сервер столкнулся с неожиданными условиями, которые не позволили ему обработать запрос.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">501</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not Implemented</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Сервер не поддерживает функциональных возможностей, необходимых для выполнения запроса. Это типичный ответ, когда сервер не понимает метод в запросе и не способен выполнить запрос для ресурса. Если же метод серверу известен, но он не применим к данному ресурсу, то нужно вернуть ответ 405.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueapi"><a class="anchor" href="#trueapi"></a>API</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Все методы пользовательского api (<code>&lt;api base uri&gt;/api/&#8230;&#8203;</code>) отдекорированы асинхронным методом <code>@authenticated</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Все методы api с префиксом op/ предназначены для операторского интерфейса, и требуют от пользователя соответствующих прав доступа.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
методы, подразумевающие работу со структураци данных осуществляют базовою валидацию полей на стороне сервера
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Содержимое полей запроса в <code>&lt;&gt;</code>&#8201;&#8212;&#8201;указание на определенный тип поля
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Для обозначения пустого (осутствующего) содержимого в описании используется <code>----</code>. Использовать его как значение <strong>НЕ РЕКОМЕНДУЕТСЯ</strong>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Для проверки запросов в командной строке/терминале, используйте User-Agent: curl, <strong>не ниже 7.47.0</strong>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Запросы без указания <code><strong>-H "Authorization</strong></code> можно выполнить без регистрации.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Для запросов требующих авторизации учетной записи, в т.ч с правами оператора [/op], будут использованы <a href="https://ec.haxx.se/http-cookies.html">HTTP cookies</a>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Используемое кодирование для кирилицы и спец символов в GET запросах - UTF-8
В ответе - текст закодированный функцией escape
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 4. Типы полей в запросах</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Поле</th>
<th class="tableblock halign-left valign-top">тип</th>
<th class="tableblock halign-left valign-top">Описание</th>
<th class="tableblock halign-left valign-top">Пример</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USER ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID пользователя в системе (UUID в текстовом виде)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"3ea7a7b6-5623-48ba-9fb7-1bcfd4c15fa7"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USER EMAIL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Почтовый адрес пользователя (используется в качестве login)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"<a href="mailto:testuset@example.com">testuset@example.com</a>"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USER PASSWORD, NEW PASSWORD, OLD PASSWORD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Пароль пользователя в открытом виде</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"123456"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHONE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Телефон пользователя в формате 380XXYYYYYYY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"380997788999"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FIRST NAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Имя пользователя</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Иван"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LAST NAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Фамилия пользователя</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Иванов"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GENDER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Пол пользователя (словарный тип: 'undef','male','female')</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"male"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OTC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Одноразовый код (обычно - UUID в текстовом виде)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"046e053c-c35c-408f-a422-9fe20f50c35b"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">true/false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean / text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Логический флаг. Может передаваться как boolean или как строковой литерал словарного типа 'true'/'false' (строковая форма&#8201;&#8212;&#8201;предпочтительнее по причине лучшей совместимости с разными типами протоколов и серверного ПО)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true / "true"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USER RATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Совокупный показатель рейтинга пользователя в системе</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">123456789</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIRTHDAY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Дата рождения пользователя в формате YYYY-MM-DD или null (как тип)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2000-01-02"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP UTC, TIMESTAMP LOCAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Временная метка в текстовом представлении ISO формата. UTC/LOCAL&#8201;&#8212;&#8201;без/с учетом локальной временной зоны</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"2016-08-12 15:30:21.341210+00:00"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USER SOURCE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Источник создания пользователя (собственный или из внешнего API, словарный тип: 'local','kasta'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"kasta"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USER ROLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Роль(-и) пользователя в системе (словарный тип: 'guest', 'user', 'agent', 'courier', 'forwarder', 'operator', 'officer', 'manager', 'analyst', 'op_support', 'techician', 'admin')</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"user"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LANG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Источник создания пользователя (собственный или из внешнего API, словарный тип: 'en','ru','uk'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"uk"</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="true--4"><a class="anchor" href="#true--4"></a>Регистрация</h3>
<div class="sect3">
<h4 id="true--5"><a class="anchor" href="#true--5"></a>Создание пользователя</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user/reg</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"email":"&lt;USER EMAIL&gt;","password":"&lt;USER PASSWORD&gt;", "phone": "&lt;PHONE 380XXYYYYYYY&gt;", "first_name": "&lt;FIRST NAME&gt;", "last_name": "&lt;LAST NAME&gt;", "gender": "&lt;GENDER&gt;", "prefered_lang" : "&lt;LANG&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
поле <code>prefered_lang</code> является опциональным и, по-умолчанию, заполняется при создании пользователя в значение языка пользовательского интерфейса.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Пример запроса/ответа</dt>
<dt class="hdlist1">Запрос</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/user/reg" \
-H "Content-Type: application/json" \
-d '{"email":"examplemail1@exampledomain.io","password":"examplepass", "phone": "380666666667", "first_name": "Vasia", "last_name": "Pipkin", "gender": "male", "prefered_lang" : "ru"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sat, 12 Jan 2019 13:20:37 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--6"><a class="anchor" href="#true--6"></a>Создание пользователя оператором</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/user/reg</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"email":"&lt;USER EMAIL&gt;", "phone": "&lt;PHONE 380XXYYYYYYY&gt;", "first_name": "&lt;FIRST NAME&gt;", "last_name": "&lt;LAST NAME&gt;", "gender": "&lt;GENDER&gt;", "prefered_lang" : "&lt;LANG&gt;", "activate": &lt;true/false&gt;}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "id": &lt;USER ID&gt;}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если параметр <code>activate</code> false (по-умолчанию), пользователь будет создан с флагом <code>is_poor</code>, если true, то новый пользователь будет активирован.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Обычно запрос ипользуется для служебных целей.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Пример запроса/ответа</dt>
<dt class="hdlist1">Запрос</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/op/user/reg" \
-b cookie-jar.txt \
-H "Content-Type: application/json" \
-d '{"email":"examplemail2@exampledomain.io", "phone": "380666666668", "first_name": "Sara", "last_name": "Pipkin", "gender": "female", "prefered_lang" : "ru", "activate": false}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sat, 12 Jan 2019 14:01:19 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 63<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "id": "75c755df-f40a-4c85-a42b-e3c1ddeec93a",
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--7"><a class="anchor" href="#true--7"></a>Потдтверждение регистрации</h4>
<div class="sect4">
<h5 id="true--8"><a class="anchor" href="#true--8"></a>Запрос ОТС</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>otc</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>new</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"otc_type": "REGISTRATION", "email": "&lt;USER EMAIL&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/otc/new" \
-H "Content-Type: application/json" \
-d '{"otc_type": "REGISTRATION", "email": "examplemail2@exampledomain.io"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sat, 12 Jan 2019 14:17:50 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="true--9"><a class="anchor" href="#true--9"></a>Подтверждение</h5>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>otc</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>validate</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"otc_type": "REGISTRATION", "otc": "&lt;OTC&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/otc/validate" \
-H "Content-Type: application/json" \
-d '{"otc_type": "REGISTRATION", "otc": "046e053c-c35c-408f-a422-9fe20f50c35b"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Wed, 16 Jan 2019 13:38:19 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--10"><a class="anchor" href="#true--10"></a>Вход</h3>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>auth</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>login</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"username":"&lt;USER EMAIL&gt;","password":"&lt;USER PASSWORD&gt;", "remember_me": "&lt;true/false&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST https://sandbox-api.tbt-post.net/api/v1/auth/login \
-H "Content-Type: application/json; charset=utf-8" \
-d '{"username":"examplemail1@exampledomain.io","password":"examplepass","remember_me":"true"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sat, 12 Jan 2019 15:17:55 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 37<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Set-Cookie: TBT_AUTH="2|1:0|10:1547646244|8:TBT_AUTH|48:ODBkYTFkY2EtOThkMy00ODVjLWI4Y2YtOTE4M2MxMDYzMzQ0|9e9a3f3ac84bb2d8ebba1f75ed94ea6898ccf5b4dac2e2bf7faae3772c218685"; Domain=.tbt-post.net; expires=Fri, 15 Feb 2019 15:57:24 GMT; Path=/<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true,
  "roles": []
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--11"><a class="anchor" href="#true--11"></a>Выход</h3>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>auth</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>logout</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>[mode=full|other|self]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/auth/logout?mode=full" \
-H "Content-Type: application/json"</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sat, 12 Jan 2019 15:21:15 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Cache-Control: no-cache, no-store, must-revalidate<br>
Etag: "484b3032619fa1acd135d114565b0a5166281c22"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 5. Типы параметров logout::</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">параметр</th>
<th class="tableblock halign-left valign-top">тип</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">self</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">по-умолчанию, выход из текущей сессии</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">full</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">завершение всех сессий</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">other</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">завершение других сессий, кроме собственной</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="true--12"><a class="anchor" href="#true--12"></a>Восстановление пароля</h3>
<div class="sect3">
<h4 id="true--13"><a class="anchor" href="#true--13"></a>Запрос ОТС</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>otc</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>new</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"otc_type": "RESTORE_PASSWORD", "email": "&lt;USER EMAIL&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/otc/new" \
-H "Content-Type: application/json" \
-d '{"otc_type": "RESTORE_PASSWORD", "email": "examplemail1@exampledomain.io"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Wed, 16 Jan 2019 13:53:09 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--14"><a class="anchor" href="#true--14"></a>Превалидация ОТС</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>otc</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>validate</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"otc_type": "RESTORE_PASSWORD", "otc": "&lt;OTC&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/otc/validate" \
-H "Content-Type: application/json" \
-d '{"otc_type": "RESTORE_PASSWORD", "otc": "1a0fd578-fa4b-435d-9f8f-8933d4528f45"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Wed, 16 Jan 2019 14:15:35 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Если ОТС не проходит валидацию, ответ будет выглядеть так</dt>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "message": "Invalid OTC",
  "success": false
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--15"><a class="anchor" href="#true--15"></a>Изменение пароля</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user/profile</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>password</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"new_password": "&lt;NEW PASSWORD&gt;", "otc": "&lt;OTC&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/user/profile/password" \
-H "Content-Type: application/json" \
-d '{"new_password": "examplepass-new", "otc": "498c9940-4720-40bd-83b2-4edbbed5ed76"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Wed, 16 Jan 2019 14:09:20 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 0<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--16"><a class="anchor" href="#true--16"></a>Изменение пароля</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Требует авторизации. Подразумевается самостоятельное изменение авторизированным пользователем пароля, вызванное, напрмер, из пользовательского профиля.
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>PUT</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user/profile</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>password</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"new_password": "&lt;NEW PASSWORD&gt;", "old_password": "&lt;OLD PASSWORD&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X PUT "https://sandbox-api.tbt-post.net/api/v1/user/profile/password" \
-H "Content-Type: application/json" \
-b cookie-jar.txt \
-d '{"new_password": "examplepass", "old_password": "examplepass-new"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Wed, 16 Jan 2019 17:09:29 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--17"><a class="anchor" href="#true--17"></a>Пользовательский профиль</h3>
<div class="sect3">
<h4 id="true--18"><a class="anchor" href="#true--18"></a>Получение собственного профиля</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user/profile</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "first_name": "&lt;FIRST NAME&gt;", "last_name": "&lt;LAST NAME&gt;", "is_external": &lt;true/false&gt;, "phone": "&lt;PHONE 380XXYYYYYYY&gt;", "gender": "&lt;GENDER&gt;", "created_at": "&lt;TIMESTAMP UTC&gt;", "activated_at": "TIMESTAMP UTC", "modified_at": "TIMESTAMP UTC", "password_changed": "TIMESTAMP UTC", "additional_data": {}, "is_active": &lt;true/false&gt;, "sourced_by": "&lt;USER SOURCE&gt;", "rate": &lt;USER RATE&gt;, "birthday": &lt;BIRTHDAY&gt;, "id": "&lt;USER ID&gt;", "is_poor": &lt;true/false&gt;, "is_disabled": &lt;true/false&gt;, "email": "&lt;USER EMAIL&gt;", &#8230;&#8203;}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/user/profile" \
-H "Content-Type: application/json" \
-b cookie-jar.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 13 Jan 2019 10:29:00 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 953<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "03aceef3d3ae3b3eb91cda7ebfa1677c4838dcc5"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "last_name": "Pipkin",
  "confirmed_at": null,
  "rate": 0,
  "roles": [],
  "id": "6cca769e-f380-4385-805c-84232c51a60c",
  "first_name": "Vasia",
  "is_confirmed": false,
  "is_phone_valid": false,
  "email": "examplemail1@exampledomain.io",
  "parent": null,
  "is_disabled": false,
  "activated_at": "2019-01-16T13:38:19.206955+00:00",
  "is_active": true,
  "password_changed": "2019-01-16T17:09:29.347996+00:00",
  "phone": "380666666667",
  "birthday": null,
  "confirmed_by": null,
  "is_external": false,
  "nsid": 0,
  "sourced_by": "local",
  "gender": "male",
  "created_at": "2019-01-12T13:20:35.009201+00:00",
  "modified_at": "2019-01-16T17:09:29.031432+00:00",
  "success": true,
  "is_badge": false,
  "is_poor": false,
  "additional_data": {
    "prefered_lang": "ru",
    "last_login": "2019-01-16T17:08:07.319400+00:00"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--19"><a class="anchor" href="#true--19"></a>Обновление собственного профиля</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Неактуальные для контекста поля&#8201;&#8212;&#8201;игнорируются. Передавать можно только часть параметров из набора.
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>PUT</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user/profile</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"first_name": "&lt;FIRST NAME&gt;", "last_name": "&lt;LAST NAME&gt;", "gender": "&lt;GENDER&gt;", "birthday": "&lt;YYYY-MM-DD&gt;", "prefered_lang": "&lt;LANG&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>202 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X PUT "https://sandbox-api.tbt-post.net/api/v1/user/profile" \
-H "Content-Type: application/json" \
-b cookie-jar.txt \
-d '{"first_name": "Vasilii", "last_name": "Pypkin", "gender": "male", "birthday": "1980-10-20", "prefered_lang": "ru"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 202 Accepted<br>
Server: nginx/1.10.3<br>
Date: Wed, 16 Jan 2019 17:18:50 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--20"><a class="anchor" href="#true--20"></a>Получение базовых данных пользователя</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user/resolve</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;USER ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "id": "&lt;USER_ID&gt;," "first_name": "&lt;FIRST NAME&gt;", "last_name": "&lt;LAST NAME&gt;", "phone": "&lt;PHONE 380XXYYYYYYY&gt;"}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Часть цифр номера телефона пользователя скрывается для обеспечения анонимности
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/user/resolve/6cca769e-f380-4385-805c-84232c51a60c" \
-H "Content-Type: application/json" \
-b cookie-jar.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Wed, 16 Jan 2019 17:23:28 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 136<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "22d3f11c1121b6ef294a79dcf02f533dd9076ba8"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "phone": "38066XXX6667",
  "first_name": "Vasilii",
  "last_name": "Pypkin",
  "id": "6cca769e-f380-4385-805c-84232c51a60c",
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--21"><a class="anchor" href="#true--21"></a>Получение базовых данных списка пользователей</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user/resolve/list</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>id[]=&lt;USER ID&gt;&amp;id[]=&lt;USER ID&gt;&amp;&#8230;&#8203;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "users": [&lt;USER RESOLVE&gt;, &lt;USER RESOLVE&gt;, &#8230;&#8203;]}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Значение &lt;USER RESOLVE&gt; является таким же, как и выходные данные метода <code>user/resolve/&lt;USER ID&gt;</code>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/user/resolve/list?id%5B%5D=6cca769e-f380-4385-805c-84232c51a60c&amp;id%5B%5D=0d554821-c0ce-43d8-9823-d3ad8d0103fd" \
-H "Content-Type: application/json" \
-b cookie-jar.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 10:42:35 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 319<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "8aaf42d18c0f6ab1afac029e64660293e9dc709e"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "users": [
    {
      "phone": "38066XXX6667",
      "first_name": "Peter",
      "last_name": "Abramovich",
      "id": "6cca769e-f380-4385-805c-84232c51a60c"
    },
    {
      "phone": "38050XXX0752",
      "first_name": "Сара",
      "last_name": "Абибок",
      "id": "0d554821-c0ce-43d8-9823-d3ad8d0103fd"
    }
  ],
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--22"><a class="anchor" href="#true--22"></a>Получение профиля пользователя</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/user/profile</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;USER ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>&lt;phone&gt;/&lt;email&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "first_name": "&lt;FIRST NAME&gt;", "last_name": "&lt;LAST NAME&gt;", "is_external": &lt;true/false&gt;, "phone": "&lt;PHONE 380XXYYYYYYY&gt;", "gender": "&lt;GENDER&gt;", "created_at": "&lt;TIMESTAMP UTC&gt;", "activated_at": "TIMESTAMP UTC", "modified_at": "TIMESTAMP UTC", "password_changed": "TIMESTAMP UTC", "additional_data": {}, "is_active": &lt;true/false&gt;, "sourced_by": "&lt;USER SOURCE&gt;", "rate": &lt;USER RATE&gt;, "birthday": &lt;BIRTHDAY&gt;, "id": "&lt;USER ID&gt;", "is_poor": &lt;true/false&gt;, "is_disabled": &lt;true/false&gt;, "email": "&lt;USER EMAIL&gt;", "roles": [&lt;ROLES LIST&gt;], &#8230;&#8203;}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<code>user_id</code> имеет более высокий приоритет
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/user/profile?email=examplemail1@exampledomain.io" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 08:35:55 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 813<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "bec27b54affb5363ee1afcf47720a73b93b55c8f"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "last_name": "Pypkin",
  "confirmed_at": null,
  "rate": 0,
  "roles": [],
  "id": "6cca769e-f380-4385-805c-84232c51a60c",
  "first_name": "Vasilii",
  "is_confirmed": false,
  "is_phone_valid": false,
  "email": "examplemail1@exampledomain.io",
  "parent": null,
  "is_disabled": false,
  "activated_at": "2019-01-16T13:38:19.206955+00:00",
  "is_active": true,
  "password_changed": "2019-01-16T17:09:29.347996+00:00",
  "phone": "380666666667",
  "birthday": "1980-10-20",
  "confirmed_by": null,
  "block_status": null,
  "is_external": false,
  "nsid": 0,
  "sourced_by": "local",
  "gender": "male",
  "created_at": "2019-01-12T13:20:35.009201+00:00",
  "modified_at": "2019-01-16T17:18:50.255000+00:00",
  "success": true,
  "is_badge": false,
  "is_poor": false,
  "additional_data": {
    "prefered_lang": "ru",
    "last_login": "2019-01-16T17:08:07.319400+00:00"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--23"><a class="anchor" href="#true--23"></a>Обновление профиля пользователя</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
неактуальные для контекста поля&#8201;&#8212;&#8201;игнорируются. Передавать можно только часть параметров из набора.
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>PUT</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/user/profile</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;USER ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"first_name": "&lt;FIRST NAME&gt;", "last_name": "&lt;LAST NAME&gt;", "gender": "&lt;GENDER&gt;", "birthday": "&lt;YYYY-MM-DD&gt;", "prefered_lang": "&lt;LANG&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>202 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X PUT "https://sandbox-api.tbt-post.net/api/v1/op/user/profile/6cca769e-f380-4385-805c-84232c51a60c" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{"first_name": "Peter", "last_name": "Abramovich", "gender": "male", "birthday": "1985-05-05", "prefered_lang": "en"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 202 Accepted<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 08:41:10 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--24"><a class="anchor" href="#true--24"></a>Подтверждение профиля пользователя оператором</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/user/profile</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>confirm</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"user_id": "&lt;USER ID&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/op/user/profile/confirm" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{"user_id": "6cca769e-f380-4385-805c-84232c51a60c"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 08:44:02 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true-id"><a class="anchor" href="#true-id"></a>Получение списка пользователей по id</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/user/list</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>id[]=&lt;USER ID&gt;&amp;id[]=&lt;USER ID&gt;&amp;&#8230;&#8203;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "users": [&lt;USER PROFILE&gt;, &lt;USER PROFILE&gt;, &#8230;&#8203;]}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Значение &lt;USER PROFILE&gt; является таким же, как и выходные данные метода <code>op/user/profile/&lt;USER ID&gt;</code>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/user/list?id%5B%5D=6cca769e-f380-4385-805c-84232c51a60c&amp;id%5B%5D=0d554821-c0ce-43d8-9823-d3ad8d0103fd" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 10:47:04 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 1565<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "6a44d9ea2b31f9974f50d93e413fc4e44648e97a"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "users": [
    {
      "last_name": "Abramovich",
      "confirmed_at": "2019-01-17T08:44:01.981119+00:00",
      "rate": 0,
      "id": "6cca769e-f380-4385-805c-84232c51a60c",
      "first_name": "Peter",
      "is_confirmed": true,
      "is_phone_valid": false,
      "email": "examplemail1@exampledomain.io",
      "parent": null,
      "activated_at": "2019-01-16T13:38:19.206955+00:00",
      "is_active": true,
      "password_changed": "2019-01-16T17:09:29.347996+00:00",
      "phone": "380666666667",
      "birthday": "1985-05-05",
      "confirmed_by": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "is_external": false,
      "block_status": null,
      "roles": null,
      "nsid": 0,
      "sourced_by": "local",
      "gender": "male",
      "created_at": "2019-01-12T13:20:35.009201+00:00",
      "modified_at": "2019-01-17T08:44:01.981201+00:00",
      "is_badge": false,
      "is_poor": false,
      "additional_data": {
        "prefered_lang": "ru",
        "last_login": "2019-01-16T17:08:07.319400+00:00"
      }
    },
    {
      "last_name": "Абибок",
      "confirmed_at": null,
      "rate": 0,
      "id": "0d554821-c0ce-43d8-9823-d3ad8d0103fd",
      "first_name": "Сара",
      "is_confirmed": false,
      "is_phone_valid": false,
      "email": "SaraAbibok@inbox.com",
      "parent": null,
      "activated_at": null,
      "is_active": false,
      "password_changed": null,
      "phone": "380505005002,
      "birthday": null,
      "confirmed_by": null,
      "is_external": false,
      "block_status": null,
      "roles": null,
      "nsid": 0,
      "sourced_by": "kasta",
      "gender": "undef",
      "created_at": "2016-12-10T04:06:19.100235+00:00",
      "modified_at": "2016-12-10T04:06:19.100247+00:00",
      "is_badge": false,
      "is_poor": true,
      "additional_data": {
        "foreign_id": 1747577
      }
    }
  ],
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--25"><a class="anchor" href="#true--25"></a>Поиск пользователей</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/user/search</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>&lt;user_model_field&gt;,sort_by,sort_order,limit,offset</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "users": [&lt;USER PROFILE&gt;, &lt;USER PROFILE&gt;, &#8230;&#8203;], "total": &lt;search_result_length&gt;}</p>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 6. Типы параметров поиска:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">параметр</th>
<th class="tableblock halign-left valign-top">тип</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;num&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">offset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;offset&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort_by</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;user_model_field&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort_order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asc/desc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;user_model_field&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">['first_name', 'last_name', 'gender', 'birthday', 'sourced_by', 'block_status', 'parent', 'confirmed_by', 'is_poor', 'is_active', 'is_external', 'is_phone_valid', 'is_confirmed']</p></td>
</tr>
</tbody>
</table>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/user/search?first_name=Test&amp;last_name=User" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 08:50:38 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 784<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "8d811a61b639ba2f4ce704bd1106e5febada2f0e"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "total": 1,
  "users": [
    {
      "last_name": "User",
      "confirmed_at": null,
      "rate": 0,
      "id": "cf8b0967-f1d3-4e53-aa48-297940415263",
      "first_name": "Test",
      "is_confirmed": false,
      "is_phone_valid": false,
      "email": "example@example.com",
      "parent": null,
      "activated_at": "2016-10-12T08:22:08.871838+00:00",
      "is_active": false,
      "password_changed": "2019-01-12T15:04:06.391445+00:00",
      "phone": "380666666666",
      "birthday": "1980-01-01",
      "confirmed_by": null,
      "is_external": false,
      "block_status": null,
      "roles": null,
      "nsid": 0,
      "sourced_by": "local",
      "gender": "male",
      "created_at": "2016-10-12T08:22:08.871824+00:00",
      "modified_at": "2019-01-12T15:04:06.073544+00:00",
      "is_badge": false,
      "is_poor": true,
      "additional_data": {
        "created_by": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680"
      }
    }
  ],
  "success": true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--26"><a class="anchor" href="#true--26"></a>Вход по номеру телефона</h3>
<div class="sect3">
<h4 id="true--27"><a class="anchor" href="#true--27"></a>Запрос кода</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
приватная часть кода <code>&lt;SMS CODE&gt;</code> будет выслана на указанный в запросе номер в случае его актуальности и валидности
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>auth/phone</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>new</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"phone": "&lt;PHONE 380XXYYYYYYY&gt;" }</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"otc": "&lt;OTC&gt;", "success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/auth/phone/new" \
-H "Content-Type: application/json" \
-d '{"phone": "380666666667"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 08:54:42 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 64<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "otc": "d346e741-473e-4edf-8a3f-903c3ac99f72",
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--28"><a class="anchor" href="#true--28"></a>Авторизация</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>auth/phone</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>login</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"otc": "&lt;OTC&gt;", "sms_code": "&lt;SMS CODE&gt;", "remember_me": true|false}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/auth/phone/login" \
-H "Content-Type: application/json" \
-d '{"otc": "ec0b678e-728c-4465-a20e-91a6b1d1ea18", "sms_code": "303941890", "remember_me": true}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 11:11:36 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 30<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true,
  "roles": []
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--29"><a class="anchor" href="#true--29"></a>Изменение телефона</h3>
<div class="sect3">
<h4 id="true--30"><a class="anchor" href="#true--30"></a>Запрос ОТС</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>otc</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>new</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"otc_type": "PHONE_CHANGE", "phone": "&lt;PHONE 380XXYYYYYYY&gt;" }</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"otc": "&lt;OTC&gt;", "success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/otc/new" \
-H "Content-Type: application/json" \
-b cookie-jar.txt \
-d '{"otc_type": "PHONE_CHANGE", "phone": "380666666677"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 11:20:30 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 64<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "otc": "5a266aaa-da39-404e-9c21-11207a1b47a6",
  "success": true
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
В запросе необходимо указывать необходимый для смены номер.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--31"><a class="anchor" href="#true--31"></a>Подтверждение</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>otc</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>validate</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"otc_type": "PHONE_CHANGE", "otc": "&lt;OTC&gt;", "sms_code": "&lt;SMS CODE&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/otc/validate" \
-H "Content-Type: application/json" \
-d '{"otc_type": "PHONE_CHANGE", "otc": "5a266aaa-da39-404e-9c21-11207a1b47a6", "sms_code": "872386376"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 11:33:53 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true-email"><a class="anchor" href="#true-email"></a>Изменение email</h3>
<div class="sect3">
<h4 id="true--32"><a class="anchor" href="#true--32"></a>Запрос ОТС</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>otc</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>new</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"otc_type": "EMAIL_CHANGE", "email": "&lt;USER EMAIL&gt;" }</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/otc/new" \
-H "Content-Type: application/json" \
-b cookie-jar.txt \
-d '{"otc_type": "EMAIL_CHANGE", "email": "example@exampledomain.io" }'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 11:37:28 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--33"><a class="anchor" href="#true--33"></a>Подтверждение</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>otc</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>validate</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"otc_type": "EMAIL_CHANGE", "otc": "&lt;OTC&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/otc/validate" \
-H "Content-Type: application/json" \
-d '{"otc_type": "EMAIL_CHANGE", "otc": "8dfe3d63-a9b2-482a-9217-daae0b126f90"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 11:41:54 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueacl"><a class="anchor" href="#trueacl"></a>ACL</h3>
<div class="sect3">
<h4 id="true--34"><a class="anchor" href="#true--34"></a>Роли пользоватлея</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>roles</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "roles": ["&lt;USER ROLE&gt;", &#8230;&#8203;]}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/user/roles" \
-H "Content-Type: application/json" \
-b cookie-jar.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 13 Jan 2019 10:45:00 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 100<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "cf70b22ea6546b1f69cb5fbc06b683d6932caf92"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true,
  "roles": [
    "user",
    "operator"
  ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--35"><a class="anchor" href="#true--35"></a>Посылки</h3>
<div class="sect3">
<h4 id="true-id-code"><a class="anchor" href="#true-id-code"></a>Получение по id/code</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>[op/] parcel</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;PARCEL ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>&lt;code&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "address_id": "&lt;SHIPPING ADDRESS ID&gt;", "code": "&lt;CODE-128&gt;", "is_paid": &lt;true/false&gt;, "weight": &lt;WEIGHT GRAM as DECIMAL(10,6)&gt;, "agent": "&lt;USER ID&gt;", "is_open": &lt;true/false&gt;, "paid_at": "&lt;TIMESTAMP UTC&gt; or null", "closed_at": "&lt;TIMESTAMP UTC or null&gt;", "id": "&lt;PARCEL ID&gt;", "paid_amount": &lt;PAYMENTS TOTAL as DECIMAL(10,2)&gt;, "type": &lt;TYPE CODE&gt;, "parent": &lt;PARCEL ID or null&gt;, "price": &lt;PRICE as DECIMAL(10,2)&gt;, "cod_amount": &lt;PRICE as DECIMAL(10,2)&gt; "class": "&lt;CLASS ID&gt;", "sender": "&lt;USER ID&gt;", "created_at": "&lt;TIMESTAMP UTC&gt;", "modified_at": "&lt;TIMESTAMP UTC&gt;", "receiver": "&lt;USER ID&gt;", "state": "&lt;PARCEL STATE&gt;", "transfer_via": "&lt;OFFCIE ID&gt;", "pentity": "&lt;OFFICE ENTITY ID&gt;", "delivery_type": "&lt;DELIVERY TYPE&gt;", "additional_data": {&#8230;&#8203;}, &#8230;&#8203;}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<code>parcel_id</code> имеет более высокий приоритет, чем <code>code</code>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/parcel/4d52c496-9137-4e8a-bb1b-56f378669ac0" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 09:12:04 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 1477<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "ab05045ba94b1887181caa4218bd241a30b5702f"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "address_id": "f50a7aaa-8a1d-11e6-8a66-83b0de5b609d",
  "code": "TEST0002",
  "weight": 1520,
  "agent": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
  "is_dirty": false,
  "is_open": true,
  "paid_at": null,
  "closed_at": null,
  "id": "4d52c496-9137-4e8a-bb1b-56f378669ac0",
  "paid_amount": 0,
  "state": "PU0007",
  "mark": null,
  "last_seen_at": null,
  "type": "fragile",
  "delivery_type": "W2W",
  "parent": null,
  "price": 2500,
  "checked_in_at": "2018-12-12T13:50:42.870075+00:00",
  "class": "A.PRP.NR.NA.S000",
  "pentity": null,
  "transfer_via": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
  "sender": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
  "nsid": 0,
  "is_paid": false,
  "modified_at": "2018-12-12T13:51:10.483000+00:00",
  "success": true,
  "additional_data": {
    "erp_token": "510ad08a-830e-46aa-ab63-dfade75a00a7",
    "_receiver": {
      "phone": "380666666666",
      "first_name": "Test",
      "last_name": "User",
      "id": 0,
      "email": "example@expmail.com"
    },
    "invoices": [
      {
        "origin": "4f90b36a-8622-4f43-a285-f622186f4ee8",
        "sms_notifications": 0.6,
        "office_delivery": 24,
        "owner": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
        "serial": "a6e96cc0-fe04-11e8-8a37-148b3fc90e15",
        "main_transportation": 10.01,
        "delivery_insurance": 16.25
      }
    ],
    "checked_in_loc": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
    "ttl_days_default": 15,
    "ttl_days": 15
  },
  "receiver": "67719cba-5cd5-4dd0-84c9-6b6864a75066",
  "cod_amount": 0,
  "created_at": "2018-12-11T14:23:51.628901+00:00",
  "goes_back": false
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--36"><a class="anchor" href="#true--36"></a>Получение графических кодов</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>[op/] parcel/codes</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;PARCEL ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "qr": &lt;IMAGE DATA URI&gt;", "bcode": "&lt;IMAGE DATA URI&gt;"}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
DATA URI is according to <code>RFC-2397</code>: data:[&lt;media type&gt;][;base64],&lt;data&gt;
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/parcel/codes/4d52c496-9137-4e8a-bb1b-56f378669ac0" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 09:16:24 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 4040<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "2b06b6d02fb247c191d703bb325ca1173138a2bd"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "qr": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAACyAQAAAADO8ajFAAAE9klEQVR4nNVXz4fl1xKv7ro8TY0aZvUITxjeqqlWTQxnVG8fTf6GEN52yCpkE7J9hLcaQv6JkNVwWg0jnOtcejU0EYaswmnn0oa6KvuYe2b73ndZPj4+p+pTP74nCR/6bk4/GAb434ufbG5gu7+4fL2Fy93F9vkF3J9cHcVD2kzpYEoZrbA1G5pWj+NFYXD1rpXnyJRExY/graQgzvQ6baCv8BsA0K3CzvaPujyy76/GJ+8er97L9TD3FwZv84u3tpPd3R8Qx/EneYLyl9hhZ98e15/JgNUKBjYrzKNa5lH9p3Cxedef4Q0UfLW/eVOfXsP95rgeyOzRZEy1UOaEIVj9OD+kj+iDWKq2mZTUs41V/iMiHIAyfNbRRafiih+d2aYnSyP1FjLW/NamVVRlQx6TsxAv+dUdc7QiHk6UVD14xQ+cnjxrrz2nNnFAWPEXt5jQB5hW66hZmqzwPUCbhvamXSqnGC/zz97KHFCGxjCs0j3myg/w7Kvb7Z29/sfZZ7++qsSfnl3uVn6Q2pUkajcHLRPIC630TJrQU91HcgB1YY1lP6I4QiWp4eJTEput8JMFotPMhoa1tJk8V/gK6OpAU9PBYKSDLfWbyWCD5mgGvWna2j8KA1WlS1YFIQ1d1PcUiOj6jwPhpz88fkFwp98/odvVPEQgagHGMjowysf0a8PGMcFqS1WOSiGr/BCgaPbpNls1KhXX7+VGOQBpVjAaLWuWsXqv7J9e7Pzgb7/Jb//568ONbeB65TdOKzZH1Tp6KUqTaOkf9jJkAHWzhp7R/CP1ChvNlAXrNCgMSbriVy/dgA3LDOsK3cuiH0/hP9coYOeH9w/bN/cXZwyH11er+lYdPcGxy+w9fWLaUg83iFkJJrlNaUWaLudDl+ZzAgoXpJ7Fci7mA+RoNCWpsSiGdZutLfmreEWJUm106kmZsfADJLYcwc25aBfkAZV1hW+VipUs0dBgNG595TfIliZt9tJj9Cg0jfvSD71maZYaHSJaYMux2KeQQeAEkT3UWRNHNz6O38Dtnq/G1cb2rwjuz24KXR5k5X8yADaD5EFWMI1tcZ+cwu97hXf3ezr56e6n/Zv3j74b+2d1wa+GoGiUA8nIB6Et910CBjZAVmQQK81gub+iiGZYjUAayaE0lv4BmRW1ZdXwbJMi1/wjq0yChjF9DKfksfRzOk4SKMDKhUSz05J/ZiuljsJ9NJ/QlVb3FSTOoZheAWOSOmSHRT43QP/aE5xI9xc70Puz8pqq8NF7fgO/Xf24h6//u5EDwuHu3/Vs/8lY+af2Ku4QIhoji2vRZX4cBhWyItl76qTW1/1bqClIL7WhhTaakUt+kCg0yQemRx9aZln0yykwP7l993c/7N5fnm/2n798uHvzdDk/PUCS2WV61yCrddnvNdSxB1pHEyBz60t/qhSHPjpqZDMU9rK8t4HhEF88+bJt/7bZv/qFf3vx3W6pf3ogz8Fm3tkH1SzLedWQreCMRkUGcc2sy/cO645AVWaAqWSF5b2aaV3BhGlWo0rQ1/sIsKmLFpd0RS4zdTHPT8HGVy+v7+ih7HZC5wd8fqDD8v5Ubh5QqBcD7WU6LPMjqoDDpwUCh88p0Zf1grfzl+uvt9uHcz5/oLPnP3y2X+mxOaKn4CTXLEMkaeH/Ddw8PgfejtudfvPyBm8J4eez1f/gB8P/N//7fwKlha0A3o4jOwAAAABJRU5ErkJggg==",
  "bcode": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAABzCAIAAAC3jEg6AAAGK0lEQVR4nO3cSWgTfRiA8TeaNGpj6gJWMFZIrVAXKrmIqFiJDT1pUTwIRcEePKQnF0Q81JsH6c1qwZPkUJEKgiLi2rhUBDFipbhUEaVougiKmqaNme8wfCFfE9Ms8yqffX43Z97M/GfoQ9Jp0GYYhgDQMeNPLwD4mxEYoIjAAEUEBigiMEARgQGKCAxQRGCAIgIDFBEYoMg+5YTNZkv/p/nVqtTG9G9aZd1Y0NEyd/3qCDmWkfVcqYH0l5e+NmuPlvUIWa80x3Gy7so9k2Nj1svJsav0F+a+0il/tApaW9YZSxaTwjsYoIjAAEUEBigiMEARgQGKCAxQRGCAIgIDFBEYoIjAAEUEBigiMEARgQGKCAxQRGCAIgIDFBEYoIjAAEUEBigiMEARgQGKCAxQRGCAIgIDFBEYoIjAAEUEBigiMEARgQGKCAxQRGCAIgIDFBEYoIjAAEUEBigiMEARgQGKCAxQRGCAIgIDFBEYoIjAAEUEBigiMEARgQGKCAxQRGCAIgIDFBEYoIjAAEUEBigiMEARgQGKCAxQRGCAIgIDFBEYoIjAAEUEBiiyGYbxp9cA/LV4BwMUERigiMAARQQGKCIwQBGBAYoIDFBEYIAiAgMUERigiMD+49ChQ7acWltbRWRkZCT3QEooFNq4caPb7Xa73T6f7+jRo69evSroXKbHjx83NjZWVFS43e6GhoaHDx9mLr70mXg8fuHChW3btnm9XqfTWVlZuWvXrkgkUvqNnb4MpDl48GDu2xUMBg3DGB4ezj1g2r9/f+bAkiVLCjqXYRiPHj1yOp3puxwOx927d9NXbsnM2bNnM5fhcDguX76sdMP/egSWS3l5uYhMTExM2m4Glkolq9u3b4tIeXl5Z2fnx48fv3///vz581OnTgUCgYLOZRiGz+cTkebm5k+fPg0NDbW0tIjIqlWrksmktTOhUGjHjh3d3d2vX7/+8eNHX19fIBAQkcWLF2ddGKZEYLmUEtiBAwdEpL29vcRzPXnyREQ8Hk88Hje3TExMeL1eEXnw4IG1M5m+fPnicrlEJBKJ5HkhSMfvYFq+ffsmIjU1NSUeJxwOi0hTU1NZWZm5xW6379y5U0Tu3Llj7Uwmt9ttRphMJku8kOmJwLSsXLlSRDo7O83SimY+FFmzZk36xrq6utQuC2cyxePxd+/ezZs3b/Xq1aVcxbRFYMUbHBzMfPR37do1c29LS0tVVdXVq1erqqp2797d0dHx4sWLIs4yOjoqIpWVlekbFy1alNpl4Uym9vb2r1+/HjlyJPW+h4IQmBaXy9Xb27tnz55YLHb+/PnW1tba2tpNmzb19fUVdJyxsTERKSsrGxwc9Hq9y5Yte/v2rfkwMBaLWTszSTgcbmtrq6+vP3z4cHE3AQRWvKwPORobG9MHzp07Nzo6euPGjba2trq6uvv379fX14+MjOR/llmzZonI+Ph4MplMJBLmE794PC4is2fPtnYm3dOnT5uammpqai5evDhz5syi7hAITN+cOXO2bt16/PjxSCQSDAY/f/7c0dGR/8sXLlwoItFodOnSpe/fv//w4UN1dfXQ0FBql4UzKf39/Q0NDRUVFdevX1+wYEGJd2A6I7Dfx2az7d27V0T6+/vzf9WKFStEZNIHy2fPnqV2WThjevnypd/vdzgct27d8ng8+S8VmQjstzKf182YUcBt37x5s4hcunRpfHzc3JJIJLq7u0Vky5Yt1s6IyMDAgN/vTyQSN2/erK6uLvZC8a/f/He3/5dS/tB8+vTpffv2XblyZWBgIBaLRaPRUChkfhg7c+ZM/ucyDGPt2rUi0tzcHI1Gh4eHzW9g1NbW/vz509qZN2/eeDye+fPn82dlqxBYLrkDy2rDhg3mzMmTJ7MOrFu3bmxsLP9zGYbR29s76TuEdru9p6fH8pljx4796rq6urqKu4fTHB8RtQSDwa6uru3bty9fvtzpdLpcLp/Pd+LEiZ6enkk/5VNav379vXv3AoHA3LlzXS6X3+8Ph8PmRz7LZ2At/mdfQBHvYIAiAgMUERigiMAARQQGKCIwQBGBAYoIDFBEYIAiAgMUERigiMAARQQGKCIwQBGBAYoIDFBEYICifwAnfbNqPTt/mgAAAABJRU5ErkJggg==",
  "success": true
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если вставить полученный код в строке браузера, напримпр: "Crhome", то в результате получим изображение необходимого кода. Копировать необходимо без скобок, например: <code>data:image/png;base64,iV&#8230;&#8203;&lt;body&gt;&#8230;&#8203;U5ErkJggg==</code>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--37"><a class="anchor" href="#true--37"></a>Поиск</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/parcel/search</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>&lt;&lt;parcel_model_field&gt;office_id/pentity/receiver_phone/sender_phone/participant_phone/sender_email/pattern_id/pattern_code/state[]/interval_from/interval_to&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {
    "parcels": [
        {
            "additional_data": {&#8230;&#8203;},
            "address_id": "&lt;SHIPPING ADDRESS ID&gt;",
            "agent": "&lt;USER ID&gt;",
            "class": "&lt;CLASS ID&gt;",
            "closed_at": "&lt;TIMESTAMP UTC&gt;",
            "code": "&lt;CODE-128&gt;",
            "created_at": "&lt;TIMESTAMP UTC&gt;",
            "id": "&lt;PARCEL ID&gt;",
            "is_open": &lt;true/false&gt;,
            "is_paid": &lt;true/false&gt;,
            "modified_at": "&lt;TIMESTAMP UTC&gt;",
            "cod_amount": &lt;PAYMENTS TOTAL as DECIMAL(10,2)&gt;,
            "paid_amount": &lt;PAYMENTS TOTAL as DECIMAL(10,2)&gt;,
            "paid_at": "&lt;TIMESTAMP UTC&gt;",
            "parent": &lt;PARCEL ID or null&gt;,
            "price": &lt;PRICE as DECIMAL(10,2)&gt;,
            "receiver": "&lt;USER ID&gt;",
            "sender": "&lt;USER ID&gt;",
            "type": &lt;TYPE CODE&gt;,
            "weight": &lt;WEIGHT GRAM as DECIMAL(10,6)&gt;,
            "state": "&lt;PARCEL STATE&gt;",
            "transfer_via": "&lt;OFFCIE ID&gt;",
            "pentity": "&lt;OFFICE ENTITY ID&gt;",
            "delivery_type": "&lt;DELIVERY TYPE&gt;",
           &#8230;&#8203;
        }
    ],
    "total": &lt;search_result_length&gt;,
    "success": true
}</p>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 7. Типы параметров поиска:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">параметр</th>
<th class="tableblock halign-left valign-top">тип</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;num&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">offset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;offset&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort_by</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;parcel_model_field&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort_order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asc/desc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;parcel_model_field&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">['sender', 'receiver', 'agent', 'parent', 'address_id', 'transfer_via', 'type', 'class', 'state', 'is_open', 'is_paid', 'goes_back']</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">office_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;uuid&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pentity - рекурсивный поиск по ресурсу отделения</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;uuid&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">state[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;parcel state list&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">receiver_phone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;phone&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sender_phone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;phone&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">participant_phone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;phone&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sender_email</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;email&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pattern_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;like pattern&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pattern_code</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;like pattern&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">interval_from</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;date-time&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">interval_to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;date-time&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">interval_field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">created_at/modified_at/checked_in_at (default created_at)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pentity_recur</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true/false  - поиск рекурсивно по полю pentity</p></td>
</tr>
</tbody>
</table>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/parcel/search?state=PU0007&amp;interval_field=created_at&amp;interval_from=2018-12-01&amp;interval_to=2018-12-31" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 09:29:07 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 3098<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "5eb3fd5a38a07fe3247bb6871368e8b52d6bf29f"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "total": 2,
  "parcels": [
    {
      "address_id": "f50a7aaa-8a1d-11e6-8a66-83b0de5b609d",
      "code": "TEST0002",
      "weight": 1520,
      "agent": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
      "is_dirty": false,
      "is_open": true,
      "paid_at": null,
      "closed_at": null,
      "id": "4d52c496-9137-4e8a-bb1b-56f378669ac0",
      "paid_amount": 0,
      "state": "PU0007",
      "mark": null,
      "last_seen_at": null,
      "type": "fragile",
      "delivery_type": "W2W",
      "parent": null,
      "price": 2500,
      "checked_in_at": "2018-12-12T13:50:42.870075+00:00",
      "class": "A.PRP.NR.NA.S000",
      "pentity": null,
      "transfer_via": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
      "sender": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
      "nsid": 0,
      "is_paid": false,
      "modified_at": "2018-12-12T13:51:10.483000+00:00",
      "additional_data": {
        "erp_token": "510ad08a-830e-46aa-ab63-dfade75a00a7",
        "_receiver": {
          "phone": "380667224455",
          "first_name": "Vasia",
          "last_name": "pipkin",
          "id": 0,
          "email": "pipkin@gmail.com"
        },
        "invoices": [
          {
            "origin": "4f90b36a-8622-4f43-a285-f622186f4ee8",
            "sms_notifications": 0.6,
            "office_delivery": 24,
            "owner": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
            "serial": "a6e96cc0-fe04-11e8-8a37-148b3fc90e15",
            "main_transportation": 10.01,
            "delivery_insurance": 16.25
          }
        ],
        "checked_in_loc": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
        "ttl_days_default": 15,
        "ttl_days": 15
      },
      "receiver": "67719cba-5cd5-4dd0-84c9-6b6864a75066",
      "cod_amount": 0,
      "created_at": "2018-12-11T14:23:51.628901+00:00",
      "goes_back": false
    },
    {
      "address_id": "f50a7aaa-8a1d-11e6-8a66-83b0de5b609d",
      "code": "TEST0004",
      "weight": 145,
      "agent": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
      "is_dirty": false,
      "is_open": true,
      "paid_at": null,
      "closed_at": null,
      "id": "30ca60d8-7d9b-47b3-a7b7-e40ff2fdefd2",
      "paid_amount": 0,
      "state": "PU0007",
      "mark": null,
      "last_seen_at": null,
      "type": "fragile",
      "delivery_type": "W2W",
      "parent": null,
      "price": 350,
      "checked_in_at": "2018-12-12T14:08:44.447137+00:00",
      "class": "A.COD.NR.NA.S000",
      "pentity": null,
      "transfer_via": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
      "sender": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
      "nsid": 0,
      "is_paid": false,
      "modified_at": "2019-01-08T09:12:25.375000+00:00",
      "additional_data": {
        "erp_token": "510ad08a-830e-46aa-ab63-dfade75a00a7",
        "_receiver": {
          "phone": "380674552233",
          "first_name": "Peter",
          "last_name": "Abrmovich",
          "id": 0,
          "email": "Abrmovich@gmail.com"
        },
        "_dimensions": [
          250,
          400,
          80
        ],
        "invoices": [
          {
            "origin": "4f90b36a-8622-4f43-a285-f622186f4ee8",
            "sms_notifications": 0.6,
            "office_delivery": 24,
            "owner": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
            "serial": "0335d220-fe14-11e8-8a37-148b3fc90e15",
            "main_transportation": 10.01,
            "delivery_insurance": 5
          }
        ],
        "_comment": "test parcel",
        "checked_in_loc": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
        "ttl_days_default": 10,
        "is_weighed": true,
        "ttl_days": 0,
        "contragent_id": "e8459d69-e3bc-41bc-978d-28d6c6abda38"
      },
      "receiver": "67719cba-5cd5-4dd0-84c9-6b6864a75066",
      "cod_amount": 299,
      "created_at": "2018-12-12T13:39:28.729083+00:00",
      "goes_back": false
    }
  ],
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true-id-2"><a class="anchor" href="#true-id-2"></a>Получение посылок по списку id</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/parcel/list</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>id[]=&lt;PARCEL ID&gt;&amp;id[]=&lt;PARCEL ID&gt;&amp;&#8230;&#8203;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {
    "parcels": [
        {
            "additional_data": {&#8230;&#8203;},
            "address_id": "&lt;SHIPPING ADDRESS ID&gt;",
            "agent": "&lt;USER ID&gt;",
            "class": "&lt;CLASS ID&gt;",
            "closed_at": "&lt;TIMESTAMP UTC&gt;",
            "code": "&lt;CODE-128&gt;",
            "created_at": "&lt;TIMESTAMP UTC&gt;",
            "id": "&lt;PARCEL ID&gt;",
            "is_open": &lt;true/false&gt;,
            "is_paid": &lt;true/false&gt;,
            "modified_at": "&lt;TIMESTAMP UTC&gt;",
            "cod_amount": &lt;PAYMENTS TOTAL as DECIMAL(10,2)&gt;,
            "paid_amount": &lt;PAYMENTS TOTAL as DECIMAL(10,2)&gt;,
            "paid_at": "&lt;TIMESTAMP UTC&gt;",
            "parent": &lt;PARCEL ID or null&gt;,
            "price": &lt;PRICE as DECIMAL(10,2)&gt;,
            "receiver": "&lt;USER ID&gt;",
            "sender": "&lt;USER ID&gt;",
            "type": &lt;TYPE CODE&gt;,
            "weight": &lt;WEIGHT GRAM as DECIMAL(10,6)&gt;,
            "state": "&lt;PARCEL STATE&gt;",
            "transfer_via": "&lt;OFFCIE ID&gt;",
            "pentity": "&lt;OFFICE ENTITY ID&gt;",
            "delivery_type": "&lt;DELIVERY TYPE&gt;",
           &#8230;&#8203;
        }
    ],
    "success": true
}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/parcel/list?id%5B%5D=30ca60d8-7d9b-47b3-a7b7-e40ff2fdefd2&amp;id%5B%5D=4d52c496-9137-4e8a-bb1b-56f378669ac0" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 10:50:56 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 3086<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "6e10481eb926db866fbe64c9332606a9b1b3e37f"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "parcels": [
    {
      "address_id": "f50a7aaa-8a1d-11e6-8a66-83b0de5b609d",
      "code": "TEST0004",
      "weight": 145,
      "agent": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
      "is_dirty": false,
      "is_open": true,
      "paid_at": null,
      "closed_at": null,
      "id": "30ca60d8-7d9b-47b3-a7b7-e40ff2fdefd2",
      "paid_amount": 0,
      "state": "PU0007",
      "mark": null,
      "last_seen_at": null,
      "type": "fragile",
      "delivery_type": "W2W",
      "parent": null,
      "price": 350,
      "checked_in_at": "2018-12-12T14:08:44.447137+00:00",
      "class": "A.COD.NR.NA.S000",
      "pentity": null,
      "transfer_via": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
      "sender": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
      "nsid": 0,
      "is_paid": false,
      "modified_at": "2019-01-08T09:12:25.375000+00:00",
      "additional_data": {
        "erp_token": "510ad08a-830e-46aa-ab63-dfade75a00a7",
        "_receiver": {
          "phone": "380666666666",
          "first_name": "Test",
          "last_name": "User",
          "id": 0,
          "email": "example@gmail.com"
        },
        "_dimensions": [
          250,
          400,
          80
        ],
        "invoices": [
          {
            "origin": "4f90b36a-8622-4f43-a285-f622186f4ee8",
            "sms_notifications": 0.6,
            "office_delivery": 24,
            "owner": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
            "serial": "0335d220-fe14-11e8-8a37-148b3fc90e15",
            "main_transportation": 10.01,
            "delivery_insurance": 5
          }
        ],
        "_comment": "test parcel",
        "checked_in_loc": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
        "ttl_days_default": 10,
        "is_weighed": true,
        "ttl_days": 0,
        "contragent_id": "e8459d69-e3bc-41bc-978d-28d6c6abda38"
      },
      "receiver": "67719cba-5cd5-4dd0-84c9-6b6864a75066",
      "cod_amount": 299,
      "created_at": "2018-12-12T13:39:28.729083+00:00",
      "goes_back": false
    },
    {
      "address_id": "f50a7aaa-8a1d-11e6-8a66-83b0de5b609d",
      "code": "TEST0002",
      "weight": 1520,
      "agent": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
      "is_dirty": false,
      "is_open": true,
      "paid_at": null,
      "closed_at": null,
      "id": "4d52c496-9137-4e8a-bb1b-56f378669ac0",
      "paid_amount": 0,
      "state": "PU0007",
      "mark": null,
      "last_seen_at": null,
      "type": "fragile",
      "delivery_type": "W2W",
      "parent": null,
      "price": 2500,
      "checked_in_at": "2018-12-12T13:50:42.870075+00:00",
      "class": "A.PRP.NR.NA.S000",
      "pentity": null,
      "transfer_via": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
      "sender": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680",
      "nsid": 0,
      "is_paid": false,
      "modified_at": "2018-12-12T13:51:10.483000+00:00",
      "additional_data": {
        "erp_token": "510ad08a-830e-46aa-ab63-dfade75a00a7",
        "_receiver": {
          "phone": "380666666666",
          "first_name": "Test",
          "last_name": "User",
          "id": 0,
          "email": "example@gmail.com"
        },
        "invoices": [
          {
            "origin": "4f90b36a-8622-4f43-a285-f622186f4ee8",
            "sms_notifications": 0.6,
            "office_delivery": 24,
            "owner": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
            "serial": "a6e96cc0-fe04-11e8-8a37-148b3fc90e15",
            "main_transportation": 10.01,
            "delivery_insurance": 16.25
          }
        ],
        "checked_in_loc": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
        "ttl_days_default": 15,
        "ttl_days": 15
      },
      "receiver": "67719cba-5cd5-4dd0-84c9-6b6864a75066",
      "cod_amount": 0,
      "created_at": "2018-12-11T14:23:51.628901+00:00",
      "goes_back": false
    }
  ],
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truec"><a class="anchor" href="#truec"></a>Cписок посылок пользователя</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>parcel/list</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>participant</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {
    "parcels": [
        {
            "additional_data": {&#8230;&#8203;},
            "address_id": "&lt;SHIPPING ADDRESS ID&gt;",
            "agent": "&lt;USER ID&gt;",
            "class": "&lt;CLASS ID&gt;",
            "closed_at": "&lt;TIMESTAMP UTC&gt;",
            "code": "&lt;CODE-128&gt;",
            "created_at": "&lt;TIMESTAMP UTC&gt;",
            "id": "&lt;PARCEL ID&gt;",
            "is_open": &lt;true/false&gt;,
            "is_paid": &lt;true/false&gt;,
            "modified_at": "&lt;TIMESTAMP UTC&gt;",
            "cod_amount": &lt;PAYMENTS TOTAL as DECIMAL(10,2)&gt;,
            "paid_amount": &lt;PAYMENTS TOTAL as DECIMAL(10,2)&gt;,
            "paid_at": "&lt;TIMESTAMP UTC&gt;",
            "parent": &lt;PARCEL ID or null&gt;,
            "price": &lt;PRICE as DECIMAL(10,2)&gt;,
            "receiver": "&lt;USER ID&gt;",
            "sender": "&lt;USER ID&gt;",
            "type": &lt;TYPE CODE&gt;,
            "weight": &lt;WEIGHT GRAM as DECIMAL(10,6)&gt;,
            "state": "&lt;PARCEL STATE&gt;",
            "transfer_via": "&lt;OFFCIE ID&gt;",
            "pentity": "&lt;OFFICE ENTITY ID&gt;",
            "delivery_type": "&lt;DELIVERY TYPE&gt;",
           &#8230;&#8203;
        }
    ],
    "total": &lt;search_result_length&gt;,
    "success": true
}</p>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<caption class="title">Table 8. Типы параметров поиска:</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">параметр</th>
<th class="tableblock halign-left valign-top">тип</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">participant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all/sender/receiver</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;num&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">offset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;offset&gt;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort_by</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">['weight', 'price', 'paid_amount', 'created_at', 'modified_at', 'paid_at', 'type', 'class', 'state', 'goes_back']</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort_order</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asc/desc</p></td>
</tr>
</tbody>
</table>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/parcel/list?participant=sender&amp;sort_by=state&amp;limit=2" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 09:45:56 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 2118<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "eeed0101eb2a9110a6833b9bba8a0f4f63e353b0"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "total": 4,
  "parcels": [
    {
      "address_id": "8579d836-8a2f-11e6-8a66-1b7b94d1a2c3",
      "code": "T1PR6NA6R",
      "weight": 1,
      "agent": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "is_dirty": false,
      "is_open": true,
      "paid_at": null,
      "closed_at": null,
      "id": "94936244-3461-406d-b773-f1f0852074bb",
      "paid_amount": 0,
      "state": "PU0003",
      "mark": null,
      "last_seen_at": null,
      "type": "undef",
      "delivery_type": "W2W",
      "parent": null,
      "price": 1,
      "checked_in_at": "2018-05-14T16:45:52.602469+00:00",
      "class": "I.PRP.NR.NA.S000",
      "pentity": "fcf598ce-7cba-47b6-9871-407b6db81ea6",
      "transfer_via": "9bfdef40-d03d-4041-92fe-c3944650f173",
      "sender": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "nsid": 0,
      "is_paid": false,
      "modified_at": "2018-08-09T08:32:31.371242+00:00",
      "additional_data": {
        "ttl_days": 30,
        "ttl_days_default": 15,
        "agent_office": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
        "checked_in_loc": "9bfdef40-d03d-4041-92fe-c3944650f173"
      },
      "receiver": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "cod_amount": 0,
      "created_at": "2018-05-14T16:38:51.780360+00:00",
      "goes_back": false
    },
    {
      "address_id": "0c722922-8a1e-11e6-8a66-b356fd9f196a",
      "code": "T1BR5NB8M",
      "weight": 2,
      "agent": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "is_dirty": false,
      "is_open": true,
      "paid_at": null,
      "closed_at": null,
      "id": "106c252b-ebb6-426f-920a-ff8f616faf3b",
      "paid_amount": 0,
      "state": "PU0003",
      "mark": null,
      "last_seen_at": null,
      "type": "undef",
      "delivery_type": "W2W",
      "parent": null,
      "price": 0,
      "checked_in_at": "2018-03-18T14:11:56.539406+00:00",
      "class": "I.COD.RA.NA.S000",
      "pentity": "18b98336-3c75-4690-8298-f65545e7df3c",
      "transfer_via": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
      "sender": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "nsid": 0,
      "is_paid": false,
      "modified_at": "2018-08-09T08:32:31.498520+00:00",
      "additional_data": {
        "ttl_days": 20,
        "ttl_days_default": 10,
        "agent_office": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253",
        "checked_in_loc": "26b10dbb-4f1b-4d45-9c19-ec3cb85d4253"
      },
      "receiver": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "cod_amount": 0,
      "created_at": "2018-03-18T14:04:13.671252+00:00",
      "goes_back": false
    }
  ],
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--38"><a class="anchor" href="#true--38"></a>Создание посылки</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/parcel</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"type": &lt;TYPE CODE&gt;, "class": "&lt;CLASS ID&gt;", "sender": "&lt;USER ID&gt;", "receiver":"&lt;USER ID&gt;", "address_id": "&lt;SHIPPING ADDRESS ID&gt;", "weight": &lt;WEIGHT GRAM as INTEGER)&gt;, "price": &lt;PRICE as DECIMAL(10,2)&gt;, "cod_amount": &lt;PRICE as DECIMAL(10,2)&gt;}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "id": "&lt;PARCEL ID&gt;"}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/op/parcel" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{"type": "fragile", "class": "A.PRP.NR.NA.S000", "sender": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680", "receiver":"6cca769e-f380-4385-805c-84232c51a60c", "address_id": "f50a7aaa-8a1d-11e6-8a66-83b0de5b609d", "weight": 1500, "price": 300, "cod_amount": 300}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 09:56:38 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 63<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "id": "728827e9-ca3e-49f3-9670-3b752736ecec",
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--39"><a class="anchor" href="#true--39"></a>Изменение посылки</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>PUT</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/parcel</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;PARCEL ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"state": "&lt;STATE ID&gt;", "type": &lt;TYPE CODE&gt;, "class": "&lt;CLASS ID&gt;", "sender": "&lt;USER ID&gt;", "receiver":"&lt;USER ID&gt;", "address_id": "&lt;SHIPPING ADDRESS ID&gt;", "transfer_via": "&lt;SHIPPING ADDRESS ID&gt;", "weight": &lt;WEIGHT GRAM as INTEGER&gt;, "price": &lt;PRICE as DECIMAL(10,2)&gt;, "paid_amount": &lt;PRICE as DECIMAL(10,2)&gt;, "cod_amount": &lt;PRICE as DECIMAL(10,2)&gt;}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>202 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
необходимо передавать подмножество описанных параметров для изменения посылки.
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X PUT "https://sandbox-api.tbt-post.net/api/v1/op/parcel/728827e9-ca3e-49f3-9670-3b752736ecec" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{"state": "PU0001", "type": "foods", "class": "A.PRP.NR.NA.S000", "sender": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680", "receiver":"6cca769e-f380-4385-805c-84232c51a60c", "address_id": "f50a7aaa-8a1d-11e6-8a66-83b0de5b609d", "transfer_via": "f50a7aaa-8a1d-11e6-8a66-83b0de5b609d", "weight": 5000, "price": 675, "paid_amount": 675, "cod_amount": 675}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 202 Accepted<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 10:03:23 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--40"><a class="anchor" href="#true--40"></a>Статистика по посылкам для отделения</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/parcel</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>office-stat</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {
    "success": true,
    "rules": {"&lt;RULE ID&gt;": ["&lt;PARCEL STATE&gt;", "&lt;PARCEL STATE&gt;",&lt;&#8230;&#8203;&gt;], "&lt;RULE ID&gt;": [&#8230;&#8203;], &#8230;&#8203;},
    "total": &lt;PARCEL COUNT as INTEGER&gt;,
    "stats": {"&lt;RULE ID&gt;": &lt;PARCEL COUNT BY RULE as INTEGER&gt;, "&lt;RULE ID&gt;": &lt;&#8230;&#8203;&gt;, &#8230;&#8203;},
    "filters": {"&lt;FILTER ID&gt;": &lt;PARCEL COUNT BY FILTER as INTEGER&gt;, "&lt;FILTER ID&gt;": &lt;&#8230;&#8203;&gt;, &#8230;&#8203;}
}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
значения rules: <code>['delivered', 'on_stock', 'in', 'release', 'new', 'in_progress', 'trans', 'out']</code>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
значения filters: <code>['returns', 'cancellations']</code>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/parcel/office-stat" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 12:08:13 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 491<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "97b8b9253b9cda00b159d122ffa5025bee3af665"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "rules": {
    "delivered": [
      "PU0007"
    ],
    "on_stock": [
      "PU0003",
      "PO0003",
      "PO0004"
    ],
    "in": [
      "PO0010",
      "PO0011"
    ],
    "release": [
      "PU0004"
    ],
    "new": [
      "PU0000",
      "PO0001",
      "PO0002"
    ],
    "in_progress": [
      "PO0005",
      "PO0006"
    ],
    "trans": [
      "PU0002",
      "PU0005",
      "PU0006",
      "PO0009"
    ],
    "out": [
      "PU0001",
      "PO0007",
      "PO0008"
    ]
  },
  "total": 65,
  "stats": {
    "delivered": 0,
    "on_stock": 14,
    "in": 0,
    "release": 0,
    "new": 0,
    "in_progress": 0,
    "trans": 2,
    "out": 42
  },
  "success": true,
  "filters": {
    "returns": 0,
    "cancellations": 0
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--41"><a class="anchor" href="#true--41"></a>Сгруппированный список посылок для отделения</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/parcel</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>grouped-list</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>office_id</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {
    "success": true,
    "grouped": { "&lt;GROUP&gt;": ["&lt;PARCEL&gt;", "&lt;PARCEL&gt;", &#8230;&#8203;], &#8230;&#8203;}
}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/parcel/grouped-list?office_id=7dea0898-865d-4f11-af5b-337acf3464f2" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 12:12:50 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 8468<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "5dbd204337166e3104e2671a00257d32a72ca716"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "grouped": [
    {
      "group": "inbox",
      "parcels": [
        {
          "address_id": "5acc5178-8bb9-11e6-9a61-83019362fcae",
          "code": "T8BMY33DM",
          "weight": 0,
          "agent": "44823a06-067c-4cbc-9193-675abaf35e4b",
          "is_dirty": false,
          "is_open": true,
          "paid_at": null,
          "closed_at": null,
          "id": "2bab4b39-1a6f-417e-a8e7-4ad59bfbfdd3",
          "paid_amount": 0,
          "entity_type": "shelf",
          "state": "PU0099",
          "mark": "R",
          "last_seen_at": "2018-06-26T13:39:30.556186+00:00",
          "type": "undef",
          "delivery_type": "W2W",
          "parent": null,
          "price": 0,
          "checked_in_at": null,
          "class": "I.PRP.NR.NA.S000",
          "pentity": "0223928d-46c1-4d00-940b-63a4e430295e",
          "transfer_via": null,
          "sender": "7dea0898-865d-4f11-af5b-337acf3464f2",
          "nsid": 0,
          "is_paid": false,
          "modified_at": "2018-05-03T07:49:31.912000+00:00",
          "additional_data": {
            "ttl_days": 15,
            "ttl_days_default": 15,
            "agent_office": "7dea0898-865d-4f11-af5b-337acf3464f2",
            "document_id": "04f1546e-6d55-11e7-94f9-00163e8cc029",
            "label": "+Возврат-T8-200717/001"
          },
          "entity_label": "inbox",
          "receiver": "1678166e-a050-430b-878a-5244ca5d8659",
          "cod_amount": 0,
          "created_at": "2017-07-20T14:09:17.620979+00:00",
          "goes_back": true
        },
        {
          "address_id": "26b6ea98-4f4a-11e6-b08e-1f448ec92245",
          "code": "M1A0PE0",
          "weight": 1000,
          "agent": "1678166e-a050-430b-878a-5244ca5d8659",
          "is_dirty": false,
          "is_open": true,
          "paid_at": null,
          "closed_at": null,
          "id": "3a7c9413-4c11-4a89-ac07-4f28e61de5b6",
          "paid_amount": 0,
          "entity_type": "shelf",
          "state": "PU0099",
          "mark": null,
          "last_seen_at": "2018-06-26T13:39:25.725169+00:00",
          "type": "undef",
          "delivery_type": "W2W",
          "parent": null,
          "price": 152,
          "checked_in_at": "2017-09-15T09:35:09.740110+00:00",
          "class": "I.COD.NR.NA.S000",
          "pentity": "0223928d-46c1-4d00-940b-63a4e430295e",
          "transfer_via": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
          "sender": "1678166e-a050-430b-878a-5244ca5d8659",
          "nsid": 0,
          "is_paid": false,
          "modified_at": "2018-05-03T07:55:02.529000+00:00",
          "additional_data": {
            "erp_token": "8ce6be3f-157d-4165-a52e-5e0d0f951eea",
            "_receiver": {
              "phone": "38063XXXX682",
              "first_name": "Test",
              "last_name": "Customer2",
              "id": 903370,
              "email": "TestCustomer2@mail.ru"
            },
            "return_via": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
            "checked_in_loc": "7dea0898-865d-4f11-af5b-337acf3464f2",
            "agent_office": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
            "ttl_days_default": 5,
            "ttl_days": 7
          },
          "entity_label": "inbox",
          "receiver": "ecfb88c6-e753-44e9-83be-6e974ecab82c",
          "cod_amount": 152,
          "created_at": "2016-12-28T13:57:21.038967+00:00",
          "goes_back": true
        }
      ]
    },
    {
      "group": "store",
      "parcels": [
        {
          "address_id": "26b6ea98-4f4a-11e6-b08e-1f448ec92245",
          "code": "M1A009A",
          "weight": 1000,
          "agent": "1678166e-a050-430b-878a-5244ca5d8659",
          "is_dirty": false,
          "is_open": true,
          "paid_at": null,
          "closed_at": null,
          "id": "b0e5b3cc-44cf-41e8-b681-4e039cddbf3b",
          "paid_amount": 191,
          "entity_type": "shelf",
          "state": "PU0007",
          "mark": null,
          "last_seen_at": "2018-06-26T13:39:12.792419+00:00",
          "type": "undef",
          "delivery_type": "W2W",
          "parent": null,
          "price": 191,
          "checked_in_at": "2017-02-05T18:36:48.570000+00:00",
          "class": "I.COD.NR.NA.S000",
          "pentity": "240f772c-65d6-4ee5-bb33-73b2f1319725",
          "transfer_via": "7dea0898-865d-4f11-af5b-337acf3464f2",
          "sender": "1678166e-a050-430b-878a-5244ca5d8659",
          "nsid": 0,
          "is_paid": true,
          "modified_at": "2018-04-19T10:41:11.068573+00:00",
          "additional_data": {
            "erp_token": "8ce6be3f-157d-4165-a52e-5e0d0f951eea",
            "_receiver": {
              "phone": "38063XXXX471",
              "first_name": "Test",
              "last_name": "Customer",
              "id": 2300700,
              "email": "testCustomer@ukr.net"
            },
            "return_via": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
            "agent_office": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
            "ttl_days_default": 5,
            "ttl_days": 5
          },
          "entity_label": "01",
          "receiver": "ae9ad33d-f07a-4694-b414-484095b111da",
          "cod_amount": 191,
          "created_at": "2016-12-28T14:27:05.295523+00:00",
          "goes_back": false
        }
      ]
    }
  ],
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--42"><a class="anchor" href="#true--42"></a>Статистика по посылкам для пользователя</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>parcel</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>stat</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "receiver": &lt;PARCEL COUNT as INTEGER&gt;, "sender": &lt;PARCEL COUNT as INTEGER&gt;, "on_release": &lt;PARCEL COUNT as INTEGER&gt;}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
значения <code>on_relese</code> - это подмножество посылок из <code>receiver</code>, готовых к выдачи пользователю.
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/parcel/stat" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 12:27:29 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 63<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "59b2fc69991ec211dedb998f5abaeeff438f4281"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "on_release": 0,
  "sender": 4,
  "success": true,
  "receiver": 22
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--43"><a class="anchor" href="#true--43"></a>Трекинговая информация о пользовательских посылках</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>parcel</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>track</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {
    "success": true,
    "sender": [{"id": "&lt;PARCEL ID&gt;", "state": "&lt;PARCEL STATE&gt;", "goes_back": &lt;true/false&gt;, "sender": "&lt;USER ID&gt;", "receiver": "&lt;USER ID&gt;", "lat": &lt;LATITUDE&gt;, "lon": &lt;LONGITUDE&gt;}, {&#8230;&#8203;}, &#8230;&#8203;],
    "receiver": [{"id": "&lt;PARCEL ID&gt;", "state": "&lt;PARCEL STATE&gt;", "goes_back": &lt;true/false&gt;, "sender": "&lt;USER ID&gt;", "receiver": "&lt;USER ID&gt;", "lat": &lt;LATITUDE&gt;, "lon": &lt;LONGITUDE&gt;}, {&#8230;&#8203;}, &#8230;&#8203;]
}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/parcel/track" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 12:30:45 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 1510<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "f93ff5a5cee4f3d4ad10ce2ed3ec110a5aa1b757"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "sender": [
    {
      "code": "T1PR6NA6R",
      "sender": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "lon": 30.45632,
      "state": "PU0003",
      "goes_back": false,
      "receiver": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "lat": 50.431722,
      "id": "94936244-3461-406d-b773-f1f0852074bb"
    },
    {
      "code": "T1BR5NB8M",
      "sender": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "lon": 30.679338,
      "state": "PU0003",
      "goes_back": false,
      "receiver": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "lat": 50.405237,
      "id": "106c252b-ebb6-426f-920a-ff8f616faf3b"
    }
  ],
  "success": true,
  "receiver": [
    {
      "code": "K26V49E",
      "sender": "1678166e-a050-430b-878a-5244ca5d8659",
      "lon": 30.679338,
      "state": "PU0099",
      "goes_back": false,
      "receiver": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "lat": 50.405237,
      "id": "be803f61-84dc-4be2-8fb2-d687acd4d7bc"
    },
    {
      "code": "K26ZXT0",
      "sender": "1678166e-a050-430b-878a-5244ca5d8659",
      "lon": 30.599589,
      "state": "PU0003",
      "goes_back": false,
      "receiver": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "lat": 50.450822,
      "id": "71d73f6a-c0e7-4053-850e-fd22fd445c18"
    },
    {
      "code": "K2700L2",
      "sender": "1678166e-a050-430b-878a-5244ca5d8659",
      "lon": 30.599589,
      "state": "PU0003",
      "goes_back": false,
      "receiver": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "lat": 50.450822,
      "id": "24a407c0-7601-4262-a07e-75551959529e"
    },
    {
      "code": "M21B01B",
      "sender": "1678166e-a050-430b-878a-5244ca5d8659",
      "lon": 30.520706,
      "state": "PU0099",
      "goes_back": false,
      "receiver": "4f90b36a-8622-4f43-a285-f622186f4ee8",
      "lat": 50.442561,
      "id": "8328aba4-1526-4f13-92f5-c6090d184597"
    }
  ]
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--44"><a class="anchor" href="#true--44"></a>Адреса и отделения</h3>
<div class="paragraph">
<p>Справочники адресов для разных языков могут отличаться. Для получения информации на конкретном языке в строке запроса можно специфировать язык при помощи параметра <code>lang=&lt;LANG&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Если язык не указан, то будет выбран либо язык пользовательского предпочтения в интерфейсе, либо язык, установленный в пользовательском профиле.</p>
</div>
<div class="sect3">
<h4 id="true--45"><a class="anchor" href="#true--45"></a>Получения данных отделений</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>offices</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>&lt;lang, all=true|false&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200
{
    "offices": [
    {
        "id": "&lt;OFFICE ID&gt;",
        "name": "&lt;OFFICE NAME&gt;",
        "descr": "&lt;OFFICE LONG NAME&gt;",
        "number": &lt;OFFICE NUMBER&gt;,
        "phone": "&lt;OFFICE PHONE&gt;",
        "email": "&lt;OFFICE EMAIL&gt;",
        "address": { &lt;ADDRESS SPEC&gt; },
        "address_data": {
            "index": "&lt;POST CODE&gt;",
            "floor": &lt;NUM&gt;,
            &#8230;&#8203;
            &lt;OPTIONAL OTHER DATA&gt;
        },
        "schedule": {
            "1": "&lt;OPEN_TIME-CLOSE_TIME | STATUS&gt;",
            "2": "&lt;OPEN_TIME-CLOSE_TIME | STATUS&gt;",
            &#8230;&#8203;
            "7": "&lt;OPEN_TIME-CLOSE_TIME | STATUS&gt;",
        },
        "optimal_hours": {&lt;OPTIMAL WORKING HOURS&gt;},
        "photos": ["&lt;PHOTO URL&gt;", &#8230;&#8203;],
        "way_photos": ["&lt;PHOTO URL&gt;", &#8230;&#8203;],
        "pay_cash": true|false,
        "pay_card": true|false,
        "additional_data": {
            "sms_addr": "&lt;SMS ADDRESS&gt;",
            "code_prefix": "&lt;OFFICE CODE PREFIX&gt;",
            "label": "&lt;OFFICE LABEL&gt;"
        },
        "ui_address": "&lt;ADDRESS LINE&gt;"
    },
    &#8230;&#8203;..
    ],
    "success": true
}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
в случае указания параметра <code>all=true</code> в списке будут отображаться так-же внутренние отделения системы.
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/offices?all=true" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 12:55:05 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 45165<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "9cfa686056f0608e98a9f2ac1b9a8a70d5a91d2f"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "offices": [
    {
      "address_data": {
        "index": "02121"
      },
      "name": "Киев, Отделение Склад",
      "descr": "Киев, Отделение Склад",
      "schedule": {},
      "is_internal": true,
      "number": 0,
      "photos": [],
      "id": "e0b05432-63a7-4e2e-9c7d-9d1eaaa04b78",
      "pay_cash": null,
      "phone": "380110000000",
      "email": "kiev_0@tbt-post.net",
      "way_photos": [],
      "optimal_hours": {},
      "services": [
        "warehouse"
      ],
      "additional_data": {
        "label": "Склад-0 (МК)",
        "code_prefix": "T0",
        "sms_addr": "Kiev, sklad modnaKasta"
      },
      "ui_address": "м.Київ, Харківське шосе 201-203к1А",
      "address": {
        "lang": "ru",
        "city": "Киев",
        "building": "201-203к1А",
        "area": null,
        "country": "UA",
        "region": "Киев",
        "lon": 30.679338,
        "geo_object": {},
        "addr_type": "fc_office",
        "note": "Отделение Склад",
        "modified_at": "2016-10-06T11:38:08.992923+00:00",
        "street": "Харьковское шоссе",
        "geo_source": "yandex",
        "lat": 50.405237,
        "id": "5acc5178-8bb9-11e6-9a61-83019362fcae",
        "accuracy": "exact"
      },
      "pay_card": null
    },
    {
      "address_data": {
        "index": "65011"
      },
      "name": "Одесса, Склад №1",
      "descr": "Одесса, Отделение Склад №1",
      "schedule": {
        "1": "09:00-20:00",
        "2": "09:00-20:00",
        "3": "09:00-20:00",
        "4": "09:00-20:00",
        "5": "09:00-20:00",
        "6": "09:00-20:00",
        "7": "-"
      },
      "is_internal": true,
      "number": 0,
      "photos": [],
      "id": "b4d9d2da-be3e-4682-b7cf-fd645f14c5e5",
      "pay_cash": true,
      "phone": "380111000000",
      "email": "odessa_0@tbt-post.net",
      "way_photos": [],
      "optimal_hours": {},
      "services": [
        "warehouse"
      ],
      "additional_data": {
        "uk:label": "Одеса-Склад-1",
        "label": "Одесса-Cклад-1",
        "code_prefix": "TK",
        "uk:sms_addr": "Odessa, viddilennia sklad 1",
        "sms_addr": "Odessa, otdelenie sklad 1"
      },
      "ui_address": "м.Одеса, Базарна вулиця 80",
      "address": {
        "lang": "ru",
        "city": "Одесса",
        "building": "80",
        "area": "Одесский городской совет",
        "country": "UA",
        "region": "Одесская область",
        "lon": 30.737777,
        "geo_object": {},
        "addr_type": "cc_office",
        "note": "Склад-1",
        "modified_at": "2018-05-08T12:12:01.037399+00:00",
        "street": "Базарная улица",
        "geo_source": "yandex",
        "lat": 46.474389,
        "id": "032af2ee-52b9-11e8-b7d9-93c11d54d8c4",
        "accuracy": "exact"
      },
      "pay_card": false
    }
  ],
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--46"><a class="anchor" href="#true--46"></a>Список адресов отделений</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>list</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>addr_type=&lt;cc_office|fc_office&gt; / id[]=&lt;ADDRESS ID&gt;&amp;id[]=&lt;ADDRESS ID&gt;&amp;&#8230;&#8203;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"address_list": [&lt;ADDRESS1&gt;, &lt;ADDRESS2&gt;, &#8230;&#8203;], "success": true}</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>где:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
cc_office
</td>
<td class="hdlist2">
<p>собственные отделения</p>
</td>
</tr>
<tr>
<td class="hdlist1">
fc_office
</td>
<td class="hdlist2">
<p>агентские отделения</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/address/list?id%5B%5D=5acc5178-8bb9-11e6-9a61-83019362fcae&amp;id%5B%5D=032af2ee-52b9-11e8-b7d9-93c11d54d8c4" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 13:12:21 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 1331<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "3cc061dde859dd8f779f8f10e98fd468a94f2522"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true,
  "address_list": [
    {
      "lang": "ru",
      "city": "Одесса",
      "building": "80",
      "area": "Одесский городской совет",
      "country": "UA",
      "region": "Одесская область",
      "lon": 30.737777,
      "geo_object": {},
      "id": "032af2ee-52b9-11e8-b7d9-93c11d54d8c4",
      "note": "Склад-1",
      "modified_at": "2018-05-08T12:12:01.037399+00:00",
      "street": "Базарная улица",
      "geo_source": "yandex",
      "lat": 46.474389,
      "addr_type": "cc_office",
      "accuracy": "exact"
    },
    {
      "lang": "ru",
      "city": "Киев",
      "building": "201-203к1А",
      "area": null,
      "country": "UA",
      "region": "Киев",
      "lon": 30.679338,
      "geo_object": {},
      "id": "5acc5178-8bb9-11e6-9a61-83019362fcae",
      "note": "Отделение Склад",
      "modified_at": "2016-10-06T11:38:08.992923+00:00",
      "street": "Харьковское шоссе",
      "geo_source": "yandex",
      "lat": 50.405237,
      "addr_type": "fc_office",
      "accuracy": "exact"
    }
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--47"><a class="anchor" href="#true--47"></a>Получение адреса из справочника</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;SHIPPING ADDRESS ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>&lt;lang &lt;lat,lon&gt; | &lt;region,city,street,building&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "lang": "&lt;LANG&gt;", "city": "&lt;CITY&gt;", "building": "&lt;BUILDING&gt;", "area": "&lt;ADDRESS AREA or null&gt;", "country": "&lt;COUNTRY CODE&gt;", "region": "&lt;CITY REGION or null&gt;", "lon": &lt;LONGITUDE&gt;, "lat": &lt;LONGITUDE&gt;, "id": "&lt;SHIPPING ADDRESS ID&gt;", "note": "&lt;TEXT or null&gt;", "modified_at": "&lt;TIMESTAMP UTC&gt;", "street": "&lt;STREET&gt;", "addr_type": "&lt;TYPE ID&gt;", "accuracy": "&lt;ADDRESS ACCURACY&gt;", "geo_source": "&lt;google|yandex|osm&gt;", "geo_object": {&lt;ADDITIONAL GEO DATA&gt;}}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
в качестве get-параметров указывается <em>либо</em> пара гео-координат, <em>либо</em> составные параметры адреса, <em>либо</em> <code>id</code> адреса.
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<code>id</code> в качестве параметра метода имеет боле высокий приоритет
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/address?region=%D0%9A%D0%B8%D0%B5%D0%B2&amp;city=%D0%9A%D0%B8%D0%B5%D0%B2&amp;street=%D0%A5%D0%B0%D1%80%D1%8C%D0%BA%D0%BE%D0%B2%D1%81%D0%BA%D0%BE%D0%B5%20%D1%88%D0%BE%D1%81%D1%81%D0%B5&amp;building=201-203" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Thu, 17 Jan 2019 13:16:30 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 525<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "252fb40a97403595bcea1297618cb1432d54adb7"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "lang": "uk",
  "city": "Київ",
  "building": "201/203",
  "success": true,
  "area": "місто Київ",
  "country": "UA",
  "region": null,
  "lon": 30.6817834,
  "geo_object": {},
  "id": "afea6db6-0074-11e9-a8b4-1f50ad4e3573",
  "note": null,
  "modified_at": "2018-12-15T14:21:17.909359+00:00",
  "street": "Харківське шосе",
  "geo_source": "google",
  "lat": 50.4035667,
  "addr_type": "regular",
  "accuracy": "exact"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--48"><a class="anchor" href="#true--48"></a>Получение списка фильтров (агрегации) адресов</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>filters</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>field=&lt;region|city|street|building&gt;,[region=&lt;AGG REGION&gt;,city=&lt;AGG CITY&gt;,street=&lt;AGG STREET&gt;, pattern=&lt;FILTER PATTERN&gt;, lang]</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "filters": [&lt;field_value_1&gt;, .. &lt;field_value_N&gt;]}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Для получения списка фильтиров (агрегации) для поля адреса более нижнего уровня, необходимо задать через get-параметры значения полей более высокого уровня в соответствии с древовидной структурой адреса: region &#8594; city &#8594; street &#8594; building.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Дополнительный параметр <code>pattern</code> используется для дополнительной фильтрации результирующего списка фильтров.
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/address/filters?field=street&amp;region=%D0%A7%D0%B5%D1%80%D0%BA%D0%B0%D1%81%D1%8C%D0%BA%D0%B0%20%D0%BE%D0%B1%D0%BB%D0%B0%D1%81%D1%82%D1%8C&amp;city=%D0%A7%D0%B5%D1%80%D0%BA%D0%B0%D1%81%D0%B8" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 12:54:00 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 2593<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "40e2be2ddfd8b645656f04ee65b10296c6fc5fe7"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true,
  "filters": [
    "бульвар Шевченка",
    "вулиця Байди Вишневецького",
    "вулиця Благовісна",
    "вулиця Вернигори",
    "вулиця Віталія Вергая",
    "вулиця В'ячеслава Чорновола",
    "вулиця Гагаріна",
    "вулиця Генерала Момота",
    "вулиця Дахнівська",
    "вулиця Лесі Українки",
    "вулиця Луценка",
    "вулиця Максима Залізняка",
    "вулиця Надпільна",
    "вулиця Нарбутівська",
    "вулиця Небесної Сотні",
    "вулиця Остафія Дашковича",
    "вулиця Самійла Кішки",
    "вулиця Сержанта Волкова",
    "вулиця Сержанта Смирнова",
    "вулиця Слави",
    "вулиця Сумгаїтська",
    "вулиця Тараскова",
    "вулиця Чехова"
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--49"><a class="anchor" href="#true--49"></a>Создание адреса в справочнике</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Кодирование и декодирование проиходят <em>с нормализацией гео-позиции</em> (т.е. результат соответствует геометрическому центру результирующего объекта)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Для создания адреса, как правило, достаточно указания в теле запроса:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>city</code>&#8201;&#8212;&#8201;город/населенный пункт</p>
</li>
<li>
<p><code>street</code>&#8201;&#8212;&#8201;улица</p>
</li>
<li>
<p><code>building</code>&#8201;&#8212;&#8201;дом</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>однако, ввиду того, что одно и то же название населенного пункта может присутствовать несколько раз в различных местностях, а улицы&#8201;&#8212;&#8201;в разных районах одного города, возможно (а в ряде случаев и рекомендовано) использовать дополнительные опциональные параметры:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>region</code>&#8201;&#8212;&#8201;область/регион</p>
</li>
<li>
<p><code>area</code>&#8201;&#8212;&#8201;район/местность</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Указание в теле запроса ключа <code>lang</code> приводит к переключению распознавания ввода и изменению языка вывода результата.</p>
</div>
<div class="paragraph">
<p>Резолвинг происходит автоматически, т.е. фактическая процедура происходит по принципу <strong>resolve and set</strong>.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"city": "&lt;CITY&gt;", "street": "&lt;STREET&gt;", "building": "&lt;BUILDING&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "building": "&lt;BUILDING&gt;", "street": "&lt;STREET&gt;", "lat": &lt;LATITUDE&gt;, "id": "&lt;SHIPPING ADDRESS ID&gt;", "lang": "&lt;LANG&gt;", "city": "&lt;CITY&gt;", "area": &lt;ADDRESS AREA or null&gt;, "country": "&lt;COUNTRY CIDE&gt;", "region": "&lt;CITY REGION or null&gt;", "lon": &lt;LONGITUDE&gt;, "accuracy": "&lt;ADDRESS ACCURACY&gt;", "geo_source": "&lt;google|yandex|osm&gt;", "geo_object": {&lt;ADDITIONAL GEO DATA&gt;}}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/address" \
-H "Content-Type: application/json" \
-b cookie-jar.txt \
-d '{"region": "Вінницька область","city": "Крижопіль", "street": "вулиця Героїв України", "building": "18", "lang": "ua" }'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 13:04:23 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 583<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "building": "18",
  "street": "вулиця Героїв України",
  "lat": 48.3836026,
  "lang": "ru",
  "city": "Крижопіль",
  "success": true,
  "area": "Крижопільський район",
  "country": "UA",
  "region": "Вінницька область",
  "lon": 28.8663538,
  "geo_source": "google",
  "accuracy": "other"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Для обратного кодирования в теле запроса необходимо указывать координаты.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"lat": &lt;LATITUDE&gt;, "lon": &lt;LONGITUDE&gt;}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "building": "&lt;BUILDING&gt;", "street": "&lt;STREET&gt;", "lat": &lt;LATITUDE&gt;, "id": "&lt;SHIPPING ADDRESS ID&gt;", "lang": "&lt;LANG&gt;", "city": "&lt;CITY&gt;", "area": &lt;ADDRESS AREA or null&gt;, "country": "&lt;COUNTRY CIDE&gt;", "region": "&lt;CITY REGION or null&gt;", "lon": &lt;LONGITUDE&gt;, "accuracy": "&lt;ADDRESS ACCURACY&gt;", "geo_source": "&lt;google|yandex|osm&gt;", "geo_object": {&lt;ADDITIONAL GEO DATA&gt;}}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/address" \
-H "Content-Type: application/json" \
-b cookie-jar.txt \
-d '{"lat": 48.386047, "lon": 28.865174}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 13:11:18 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 626<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "building": "18",
  "street": "вулиця Героїв України",
  "lat": 48.386302,
  "id": "2ce89d5e-1cb5-11e9-88a7-ab8c8bd7420b",
  "lang": "ru",
  "city": "Крижопіль",
  "success": true,
  "area": "Крижопільський район",
  "country": "UA",
  "region": "Вінницька область",
  "lon": 28.865319,
  "geo_source": "google",
  "accuracy": "exact"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--50"><a class="anchor" href="#true--50"></a>Список пользовательских адресов</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user/address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "address_list": [{"building": "&lt;BUILDING&gt;", "city": "&lt;CITY&gt;", "address_id": "&lt;SHIPPING ADDRESS ID&gt;", "service": "&lt;ADDRESS SERVICE&gt;", "apartment": "&lt;APARTMENT&gt;", "lang": "&lt;LANG&gt;", "title": "&lt;ADDRESS TITLE&gt;", "country": "&lt;COUNTRY CODE&gt;", "notes": "&lt;TEXT or null&gt;", "area": &lt;ADDRESS AREA or null&gt;, "lon": &lt;LONGITUDE&gt;, "is_default": &lt;true/false&gt;, "street": "&lt;STREET&gt;", "lat": &lt;LATITUDE&gt;, "region": "&lt;CITY REGION or null&gt;"}]}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
расширение параметризации метода идентификатором адреса (т.е.&lt;SHIPPING ADDRES ID&gt;) возвращает описание отдельного адреса (редуцирует выборку)
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/user/address" \
-H "Content-Type: application/json" \
-b cookie-jar.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 13:40:35 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 738<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "d6acb020c6f10b09190fa38a776c35472dbd7145"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true,
  "address_list": [
    {
      "building": "18",
      "city": "Крижопіль",
      "address_id": "2ce89d5e-1cb5-11e9-88a7-ab8c8bd7420b",
      "apartment": "1",
      "lang": "ru",
      "service": "courier",
      "title": "Крижопіль, вулиця Героїв України, 18",
      "country": "UA",
      "notes": "TEST",
      "area": "Крижопільський район",
      "modified_at": "2019-01-20T13:50:34.707572+00:00",
      "lon": 28.865319,
      "is_default": false,
      "street": "вулиця Героїв України",
      "additional_data": {},
      "lat": 48.386302,
      "region": "Вінницька область"
    }
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--51"><a class="anchor" href="#true--51"></a>Добавление пользовательского адреса</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>user/address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"address_id" : "&lt;SHIPPING ADDRESS ID&gt;", "service": "&lt;ADDRESS SERVICE&gt;", "title": "ADDRESS TITLE", "apartment": "&lt;APARTMENT&gt;", "notes": "TEXT"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/user/address" \
-H "Content-Type: application/json" \
-b cookie-jar.txt \
-d '{ "address_id" : "2ce89d5e-1cb5-11e9-88a7-ab8c8bd7420b", "service": "courier", "title": "Крижопіль, вулиця Героїв України, 18", "apartment": "1", "notes": "TEST"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 13:50:34 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--52"><a class="anchor" href="#true--52"></a>Список пользовательских адресов произвольного пользователя</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/user/address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;USER ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "address_list": [{"building": "&lt;BUILDING&gt;", "city": "&lt;CITY&gt;", "address_id": "&lt;SHIPPING ADDRESS ID&gt;", "apartment": "&lt;APARTMENT&gt;", "lang": "&lt;LANG&gt;", "title": "&lt;ADDRESS TITLE&gt;", "country": "&lt;COUNTRY CODE&gt;", "notes": "&lt;TEXT or null&gt;", "area": &lt;ADDRESS AREA or null&gt;, "lon": &lt;LONGITUDE&gt;, "is_default": &lt;true/false&gt;, "street": "&lt;STREET&gt;", "lat": &lt;LATITUDE&gt;, "region": "&lt;CITY REGION or null&gt;"}]}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
расширение параметризации метода идентификатором адреса (т.е. &lt;USER ID&gt;/&lt;SHIPPING ADDRES ID&gt;) возвращает описание отдельного адреса (редуцирует выборку)
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/user/address/	cf8b0967-f1d3-4e53-aa48-297940415263" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 14:08:43 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 2141<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "b63d0f8a91f618d03e2cbb3213d77c6f6837da72"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true,
  "address_list": [
    {
      "building": "18",
      "city": "Крижопіль",
      "address_id": "2ce89d5e-1cb5-11e9-88a7-ab8c8bd7420b",
      "apartment": "2",
      "lang": "ru",
      "service": "courier",
      "title": "Крижопіль, вулиця Героїв України, 18",
      "country": "UA",
      "notes": "TEST",
      "area": "Крижопільський район",
      "modified_at": "2019-01-20T13:50:34.707572+00:00",
      "lon": 28.865319,
      "is_default": false,
      "street": "вулиця Героїв України",
      "additional_data": {},
      "lat": 48.386302,
      "region": "Вінницька область"
    }
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--53"><a class="anchor" href="#true--53"></a>Добавление пользовательского адреса произвольного пользователя</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/user/address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;USER ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"address_id" : "&lt;SHIPPING ADDRESS ID&gt;", "service": "&lt;ADDRESS SERVICE&gt;", "title": "ADDRESS TITLE", "apartment": "&lt;APARTMENT&gt;", "notes": "TEXT"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/op/user/address/86761ba9-be25-47e1-8483-cb43ee3f241e" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{ "address_id" : "2ce89d5e-1cb5-11e9-88a7-ab8c8bd7420b", "service": "courier", "title": "Крижопіль, вулиця Героїв України, 18", "apartment": "2", "notes": "TEST"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 14:15:43 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--54"><a class="anchor" href="#true--54"></a>Сущности и справочники</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--55"><a class="anchor" href="#true--55"></a>Ресурсы отделения</h3>
<div class="sect3">
<h4 id="truec-2"><a class="anchor" href="#truec-2"></a>Cоздание ресурса отеления</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/entity</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"type": "&lt;ENTITY TYPE&gt;", "parent": "&lt;ENTITY ID&gt;", "descr": "&lt;ENTITY DESCRIPTION&gt;", "label": "&lt;ENTITY LABEL&gt;", "path": "&lt;PATH (1C FORMAT)&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "id": "&lt;ENTITY ID&gt;", "type": "&lt;ENTITY TYPE&gt;", "owner": "&lt;OFFICE USER ID&gt;", "parent": "&lt;ENTITY ID&gt;", "descr": "&lt;ENTITY DESCRIPTION&gt;" "properties": {"label": "&lt;ENTITY LABEL&gt;", "path": "&lt;PATH (1C FORMAT)&gt;", "db_path": ["&lt;PARENT ENTITY ID&gt;", "&lt;PARENT ENTITY ID&gt;", &#8230;&#8203;]}]}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/op/entity" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{"type": "rack", "parent": "d4ef2889-2dea-48ad-b86e-8dfe1b3cd0f9", "descr": "Test", "label": "test inbox", "path": "tst/test inbox"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Mon, 21 Jan 2019 15:03:26 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 333<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "parent": "d4ef2889-2dea-48ad-b86e-8dfe1b3cd0f9",
  "descr": "Test",
  "success": true,
  "properties": {
    "code": "$Er$F0:0014$",
    "path": "test inbox",
    "db_path": [
      "d4ef2889-XXXX-8dfe1b3cd0f9"
    ],
    "label": "test inbox"
  },
  "owner": "6beaa91b-XXXX-d8f89d700e4c",
  "type": "rack",
  "id": "afecf905-2b52-4975-9569-51c5068d4b1a"
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all" style="width: 35%;">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Возможные параметры ENTITY_TYPE</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box: Коробка</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cell: Ячейка</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">shelf: Полка</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rack: Стелаж</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">row: Ряд</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stock: Склад</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">car: Машина</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">office: Отделение</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="true--56"><a class="anchor" href="#true--56"></a>Изменение ресурса отеления</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>PUT</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/entity</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;ENTITY ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"descr": "&lt;ENTITY DESCRIPTION&gt;", "label": "&lt;ENTITY LABEL&gt;", "path": "&lt;PATH (1C FORMAT)&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "id": "&lt;ENTITY ID&gt;", "type": "&lt;ENTITY TYPE&gt;", "owner": "&lt;OFFICE USER ID&gt;", "parent": "&lt;ENTITY ID&gt;", "descr": "&lt;ENTITY DESCRIPTION&gt;" "properties": {"label": "&lt;ENTITY LABEL&gt;", "path": "&lt;PATH (1C FORMAT)&gt;", "db_path": ["&lt;PARENT ENTITY ID&gt;", "&lt;PARENT ENTITY ID&gt;", &#8230;&#8203;]}]}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
требуется указать только необходимые параметры для модификации ресурса.
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X PUT "https://sandbox-api.tbt-post.net/api/v1/op/entity/afecf905-2b52-4975-9569-51c5068d4b1a" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{"descr": "New desc", "label": "new inbox", "path": "tst/new_inbox"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Mon, 21 Jan 2019 15:06:23 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--57"><a class="anchor" href="#true--57"></a>Удаление ресурса отеления</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>DELETE</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/entity</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;ENTITY ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
удаление возможно только ресурса, который не имеет подчиненных ресурсов
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X DELETE "https://sandbox-api.tbt-post.net/api/v1/op/entity/afecf905-2b52-4975-9569-51c5068d4b1a" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Mon, 21 Jan 2019 15:16:24 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--58"><a class="anchor" href="#true--58"></a>Получение описания ресурса</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/entity</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;ENTITY ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>code=&lt;ENTITY BARCODE&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "id": "&lt;ENTITY ID&gt;", "type": "&lt;ENTITY TYPE&gt;", "owner": "&lt;OFFICE USER ID&gt;", "parent": "&lt;ENTITY ID&gt;", "descr": "&lt;ENTITY DESCRIPTION&gt;" "properties": {"code": "&lt;ENTITY BARCODE&gt;", "bcode": "&lt;DATA URI: ENTITY BARCODE&gt;", "label": "&lt;ENTITY LABEL&gt;", "path": "&lt;PATH (1C FORMAT)&gt;", "db_path": ["&lt;PARENT ENTITY ID&gt;", "&lt;PARENT ENTITY ID&gt;", &#8230;&#8203;]}]}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
получение сущности выполняется или по <code>&lt;ENTITY ID&gt;</code> в method_params или по &lt;ENTITY BARCODE&gt; в get_params
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/entity/95112660-f50e-4b7c-8b81-92139cda3aa4" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Или</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/entity?code=%24EC%24F0%3A0006%24" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 15:05:05 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 3709<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "e72d99d2e626912b9b524ec818529624a4c4ae91"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "descr": "Киев, курьерское отделение, Ряд 00, Стелаж 00, Ячейка inbox",
  "parent": "a745e8ab-9733-45cd-9650-776b06d3bbf7",
  "success": true,
  "id": "95112660-f50e-4b7c-8b81-92139cda3aa4",
  "owner": "6beaa91b-XXXX-d8f89d700e4c",
  "type": "cell",
  "properties": {
    "path": "00.00/inbox",
    "bcode": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaIAAABzCAIAAABVfJEGAAAIn0lEQVR4nO3dX0zNfxzH8Xf/RP9bVJSxikazYrMRm5J0aMOWq9aFFo1xh02GicaFzZY/V4yNuUCsGyebmSgq+VdmmpSmRZ1YU4mOU+d38d3vrNXp+JYT3/PZ83HF9/P+fj6f76f26vT9fj942e12AQB1ef/rCQDA1CLmACiOmAOgOGIOgOKIOQCKI+YAKI6YA6A4Yg6A4og5AIoj5gAozve3FV5eXiP/qm0OcxwcuVfM6cHxetN/otMJTPRER4F20HW9i1b9M/znV+q0QM/cnM7BxRCuTxxZ4/pEp3Nz0bnTJtc1Lg46ndV4TS7WTc+FO21ycTmua0ZelJ4JO52562nr/+Z3MbfxxnLRj55vCT3bVfk0B0BxxBwAxRFzABRHzAFQHDEHQHHEHADFEXMAFEfMAVAcMQdAccQcAMURcwAUR8wBUBwxB0BxxBwAxRFzABRHzAFQHDEHQHHEHADFEXMAFEfMAVAcMQdAccQcAMURcwAUR8wBUBwxB0BxxBwAxRFzABRHzAFQHDEHQHHEHADFEXMAFEfMAVAcMQdAccQcAMURcwAUR8wBUBwxB0BxxBwAxRFzABRHzAFQHDEHQHHEHADFEXMAFEfMAVAcMQdAccQcAMURcwAUR8wBUBwxB0BxxBwAxRFzABRHzAFQHDEHQHHEHADFEXMAFEfMAVAcMQdAccQcAMURcwAU52W32//1HABgCvFpDoDiiDkAiiPmACiOmAOgOGIOgOKIOQCKI+YAKI6YA6A4Yg6A4og5g6qtrV29evXY41++fPEax549e0YV37p1KzMzMyIiIigoKCUl5cSJE729vfrHEhGTyeR0rISEhJFlz549M5lMoaGhISEhmZmZNTU1k7tqPf24q2ZgYODo0aNJSUkBAQGRkZGFhYXt7e1OZ+VifeAZ7DCkmpqaVatWjT3e3d093pdy9+7djrLh4eEdO3aMrTl+/Lj+sex2e1ZWltOx4uPjHTV1dXX+/v4jW/38/B49ejTRS9bTj7tqenp6kpOTR11UTk6O04m5WB94BGLOcMxm87p168LCwry8vBITE3ft2tXQ0OBo1WIuJibGdSfnzp0TkcDAwLNnz3Z1dQ0ODr5582b//v1nzpzRP5b9/5i7d++ei7GWLVsmInl5eZ2dnRaLpaCgQESSkpKGh4cndOF6+nFXTX5+vohER0eXlZX19fX19PRcvXp13759o6b02/WBRyDmjOXUqVNjPzqFhoY6CvTEnNVqjYyMFJGbN2/+yVh2HTH34sULEYmNjR0cHNSO/Pr1Ky4uTkQeP36s44on0I+7ajo7O318fHx8fJ4/f/6H6wOPwL05A7FarcXFxb6+vteuXausrExNTW1ubr548eLSpUsn1M+DBw8sFktiYuLWrVuneqyHDx+KyJYtW6ZNm6Yd8fX1zcnJ0abh3n7cVWM2m4eGhjZt2qR97nPKXesDIyDmDMRisfT395tMptzcXH9/f+1Of0FBwYTyQkTq6+tFJD09/S+M9e7dOxFZsmTJyIPabS+taaTa2lrtCUZ1dfUk+nFXTUNDg4hkZ2e7uC53rQ+MgJgzkDlz5gQEBHR1df22sqOjY+zTz7t37zpaRWT+/PluGUtEMjMzR41VWVmpNX39+lVEoqKiRtZrvzJrTTrp6cddNdpVJyUlXbhwISEhwd/fPy4ubu/evSMfQ09ofWBwxJyBeHt7FxUV1dfXZ2dn37lzx2az2Sf1j54ODAyIyIwZM/7CWD9//hSRadOmdXR0xMXFzZs3r7W1VXvQ+ePHD/f2464abX3Ky8sLCwtbWlqsVuuHDx9Onz6dlpY2ODjo3vWBERBzxnLo0KHLly+3traWlJTU1dVFRUXl5+ePfZ/L6SMIk8mktQYEBIiOlNE5ljh7BJGWlqY1TZ8+XUSsVuvw8LDNZtOeZmphMTZnV6xYoZ0+9jU0Pf24q0a7bVdaWlpcXPzp06fe3l6z2RwdHf3y5csrV65MYn1gcMSc4Wzbtu3t27cVFRXazSCz2bx48WLtAaJOMTExItLW1vYXxoqIiBCRrq6uuXPnfvz4sb29PT4+3mKxOJrc2I+7asLDw0Vk48aNR44cmT17dnBw8IYNG44dOyYi9+/fd+/6wAiIOYMKCwuLioo6efJkVVVVf3//4cOH9Z+7fPlyEXHcPpvSsRYuXCgir1+/HnmwsbHR0eTGftxVo23hGPV6cGJiooxzP/FP1gdGQMwZXWxsrLe39/v37/Wfkp6ePnPmzKamptu3b0/1WGvWrBGR8vJyq9WqHbHZbGVlZfK7R72T6MddNampqfJ/9jk0NTWJyKxZs1xMchLrA0OYulfyMFEtLS0ZGRk3btzo6OioqalJTU1ta2vLzc0Vkc2bN2s1OndBlJaWikhQUND58+e1dyNevXp18OBBxy4IPWPZ9e2CSElJEZG8vLyurq7u7m5t18GiRYuGhoZGVTr2llZVVU2uH7fU2Gw27YXhkpKSz58/9/X1affmROTSpUsTWh94BGLOQJqbmx0/fvz8/Bx/DgkJaWxs1Gpc7Gkdue9yaGhI2880imNPq56x7Ppi7smTJ6P2kPr6+lZWVo6tdB1zevpxV01FRYWPj8+oxVm5cqXVap3Q+sAjEHMGMjw8XFVVtXPnzpSUlMDAQG9v7wULFmzfvr29vd1RozPmNNevX1+7dm14eHhgYGBycnJJScm3b9/0j2XXF3N2u/3p06fr168PDg4OCgrKyMgYb5uX65jT2Y+7aqqrq7OyssLCwvz8/BISEoqKir5//+5o1bk+8Aj8d9QGVV1dfeDAgbG7BTx9LE/E+ng6HkEYlLf33/vS/M2xPBHr4+n4+hmUl5eXkmN5ItbH0/FLKwDF8WkOgOKIOQCKI+YAKI6YA6A4Yg6A4og5AIoj5gAojpgDoDhiDoDiiDkAiiPmACiOmAOgOGIOgOKIOQCKI+YAKO4/Z1YN/bO2iEAAAAAASUVORK5CYII=",
    "code": "$EC$F0:0006$",
    "db_path": [
      "d4ef2889-XXXX-8dfe1b3cd0f9",
      "642fc9dc-XXXX-ac4864b1c452",
      "a745e8ab-XXXX-776b06d3bbf7"
    ],
    "label": "inbox"
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Если вставить полученный код в строке браузера, напримпр: "Crhome", то в результате получим изображение необходимого кода. Копировать необходимо без скобок, например: <code>data:image/png;base64,iV&#8230;&#8203;&lt;body&gt;&#8230;&#8203;U5ErkJggg==</code>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="true--59"><a class="anchor" href="#true--59"></a>Получение списка ресурсов</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/entity</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>list</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>[office_id=&lt;OFFICE USER ID&gt;] / parent=&lt;ENTITY ID&gt; / type=&lt;ENTITY TYPE&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "entities": [&lt;ENTITY RECORD&gt;, &lt;ENTITY RECORD&gt;, &#8230;&#8203;]</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
по-умолчанию office_id берется из данных операторского аккаунта, <code>&lt;ENTITY RECORD&gt;</code> соответсвует описанию результата для получения одиночной сущности за исключением поля <code>"properties"/"barcode"</code>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/op/entity/list" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 14:51:20 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 5359<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "42a61e2e40bedd8d514632d6a9b4010b4b4367de"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "entities": [
    {
      "descr": "Киев, курьерское отделение",
      "parent": "d4ef2889-2dea-48ad-b86e-8dfe1b3cd0f9",
      "id": "d4ef2889-2dea-48ad-b86e-8dfe1b3cd0f9",
      "owner": "6beaa91b-XXXX-d8f89d700e4c",
      "type": "office",
      "properties": {
        "label": "F0"
      }
    },
    {
      "descr": "Киев, курьерское отделение, Ряд 00",
      "parent": "d4ef2889-2dea-48ad-b86e-8dfe1b3cd0f9",
      "id": "642fc9dc-6e45-4916-ba4f-ac4864b1c452",
      "owner": "6beaa91b-XXXX-d8f89d700e4c",
      "type": "row",
      "properties": {
        "path": "00",
        "code": "$ER$F0:0002$",
        "label": "00",
        "db_path": [
          "d4ef2889-XXXX-8dfe1b3cd0f9"
        ]
      }
    },
    {
      "descr": "Киев, курьерское отделение, Ряд 00, Стелаж 00, Ячейка inbox",
      "parent": "a745e8ab-9733-45cd-9650-776b06d3bbf7",
      "id": "95112660-f50e-4b7c-8b81-92139cda3aa4",
      "owner": "6beaa91b-XXXX-d8f89d700e4c",
      "type": "cell",
      "properties": {
        "path": "00.00/inbox",
        "code": "$EC$F0:0006$",
        "db_path": [
          "d4ef2889-XXXX-8dfe1b3cd0f9",
          "642fc9dc-XXXX-ac4864b1c452",
          "a745e8ab-XXXX-776b06d3bbf7"
        ],
        "label": "inbox"
      }
    }
  ],
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true-e"><a class="anchor" href="#true-e"></a>Пeреназначение иерархии для ресурса отделения</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/entity/reparent</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;ENTITY ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"parent": "&lt;ENTITY ID&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/op/entity/reparent/afecf905-2b52-4975-9569-51c5068d4b1a" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{"parent": "d4ef2889-2dea-48ad-b86e-8dfe1b3cd0f9"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 14:59:26 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 78<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "descr": "New desc",
  "parent": "d4ef2889-2dea-48ad-b86e-8dfe1b3cd0f9",
  "success": true,
  "id": "afecf905-2b52-4975-9569-51c5068d4b1a",
  "owner": "6beaa91b-XXXX-d8f89d700e4c",
  "type": "rack",
  "properties": {
    "path": "new inbox",
    "code": "$Er$F0:0014$",
    "db_path": [
      "d4ef2889-XXXX-8dfe1b3cd0f9"
    ],
    "label": "new inbox"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true--60"><a class="anchor" href="#true--60"></a>Словари</h3>
<div class="sect3">
<h4 id="true--61"><a class="anchor" href="#true--61"></a>Сообщения для состояний отправлений</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>dict/parcel</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>states</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>lang=&lt;ru|uk|en&gt; default: ru</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {
    "success": true,
    "states": {"&lt;STATE ID&gt;": "&lt;STATE MESSAGE&gt;", "&lt;STATE ID&gt;": "&lt;STATE MESSAGE&gt;", &#8230;&#8203;}
}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/dict/parcel/states?lang=ru" \
-H "Content-Type: application/json" \
-b cookie-jar.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 14:29:06 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 1555<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "fb896b919bce41cf32ed9227daba8fea8ab100fd"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "states": {
    "PU0098": "В процессе обработки",
    "PU0099": "Отменено",
    "PU0096": "Расформировано",
    "PU0097": "Возврат отправителю",
    "PU0003": "В отделении",
    "PU0002": "Перемещается между отделениями",
    "PU0001": "Отправление принято к доставке",
    "PU0000": "Заявка зарегистрирована в системе",
    "PU0007": "Доставлено",
    "PU0006": "Ожидает вручения (в процессе доставки)",
    "PU0005": "Передано курьеру",
    "PU0004": "Ожидает выдачи"
  },
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--62"><a class="anchor" href="#true--62"></a>Словарь сервисов отделения</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>dict/office</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>services</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>lang=&lt;ru|uk|en&gt; default: ru</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {
  "services": {
    "&lt;SERVICE&gt;": "&lt;PARAM&gt;", "&lt;SERVICE&gt;": "&lt;PARAM&gt;", &#8230;&#8203;},
  "success": true
}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/dict/office/services?lang=ru" -H "Content-Type: application/json" -H "Authorization: Basic NTEwYWQwOGEt"</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Mon, 08 Jul 2019 13:40:51 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 852<br>
Connection: keep-alive<br>
Etag: "23c750d9fc1a4a44d4feb5a6ebe73cd25fcdfa96"<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "services": {
    "electronics_m": "Электроника (M)",
    "bioauth_face_m": "Биометрия лица (стандартная)",
    "bioauth_face_l": "Биометрия лица (полная)",
    "bioauth_face_s": "Биометрия лица (базовая)",
    "electronics_s": "Электроника (S)",
    "e_test_bed": "Место для проверки электроники"
  },
  "success": true
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="true--63"><a class="anchor" href="#true--63"></a>Сообщения для действий по отправлениям</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>GET</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>dict/parcel</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>actions</p>
</td>
</tr>
<tr>
<td class="hdlist1">
get_params
</td>
<td class="hdlist2">
<p>lang=&lt;ru|uk|en&gt; default: ru</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {
    "success": true,
    "actions": {"&lt;STATE ID&gt;": "&lt;STATE ACTION MESSAGE&gt;", "&lt;STATE ID&gt;": "&lt;STATE ACTION MESSAGE&gt;", &#8230;&#8203;}
}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X GET "https://sandbox-api.tbt-post.net/api/v1/dict/parcel/actions?lang=ru" \
-H "Content-Type: application/json" \
-b cookie-jar.txt</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Sun, 20 Jan 2019 14:31:37 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 1291<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Etag: "50cc289c90d05c376c7564e44dde2585b3cfbc1b"<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true,
  "actions": {
    "PU0098": "В процессе обработки",
    "PU0099": "Отмена",
    "PU0096": "Расформировать",
    "PU0097": "Вернуть отправителю",
    "PU0003": "Оприходовать",
    "PU0002": "Перемещается между отделениями",
    "PU0001": "Принять к доставке",
    "PU0000": "Отменить все статусы",
    "PU0007": "Выдать",
    "PU0006": "Адресная доставка",
    "PU0005": "Передать курьеру",
    "PU0004": "Готово к выдаче"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="true-batch"><a class="anchor" href="#true-batch"></a>Множественная (batch) обработка действий</h3>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/batch</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"action": "&lt;parcel_update|entity_reparent|&#8230;&#8203;&gt;", "batches": {"&lt;BATCH_KEY&gt;": {"&lt;PARAM&gt;": "&lt;VALUE&gt;", "&lt;PARAM2&gt;": "&lt;VALUE&gt;", &#8230;&#8203;}, &lt;"BATCH_KEY"&gt;: {&#8230;&#8203;}, &#8230;&#8203;}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>200 {"success": true, "&lt;BATCH_KEY&gt;": {"status": &lt;STATUS_CODE&gt;, "&lt;RESULT_KEY&gt;": &lt;VALUE&gt;, &#8230;&#8203;}, "&lt;BATCH_KEY&gt;": {&#8230;&#8203;}, &#8230;&#8203;}</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Для action = <code>parcel_update</code> &lt;BATCH_KEY&gt; является <code>parcel_id</code>, для action = <code>entity_reparent</code> &lt;BATCH_KEY&gt; является <code>entity_id</code></p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/op/batch" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{"action":"parcel_update","batches":{"252395d6-5764-4232-baeb-2020db2d8c2c":{"state":"PU0003","delivery_type":"W2W"},"0e1837e3-609f-4bc6-a121-3b21c0f11a5b":{"state":"PU0003","delivery_type":"W2W"}}}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Mon, 21 Jan 2019 11:18:36 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 131<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "0e1837e3-609f-4bc6-a121-3b21c0f11a5b": {
    "status": 202
  },
  "252395d6-5764-4232-baeb-2020db2d8c2c": {
    "status": 202
  },
  "success": true
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="true--64"><a class="anchor" href="#true--64"></a>Уведомления</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="true--65"><a class="anchor" href="#true--65"></a>Отчет интерфейса оператора</h3>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>op/report</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>----</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>&lt;ANY REPORT DATA&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>202 {"success": true, "document_id": "&lt;ID&gt;"}</p>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Ограничение объема передаваемых в запросе данных&#8201;&#8212;&#8201;2М
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/op/report" \
-H "Content-Type: application/json" \
-b cookie-jar1.txt \
-d '{"state": "PU0001", "type": "foods", "class": "A.PRP.NR.NA.S000", "sender": "44ee4ac5-8e42-4e40-821a-3f3e5f13f680"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 200 OK<br>
Server: nginx/1.10.3<br>
Date: Mon, 21 Jan 2019 14:41:18 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 72<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true,
  "document_id": "9ccc7232-1d8a-11e9-bda0-00163e8cc029"
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Применимо для отправки данных о работе оператора в графическом интерфейсе.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="true--66"><a class="anchor" href="#true--66"></a>Клиент&#8594;Система</h3>
<div class="sect3">
<h4 id="true--67"><a class="anchor" href="#true--67"></a>Забор отправления в отделении</h4>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
protocol_method
</td>
<td class="hdlist2">
<p>POST</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_name
</td>
<td class="hdlist2">
<p>ev/parcel/sched</p>
</td>
</tr>
<tr>
<td class="hdlist1">
method_params
</td>
<td class="hdlist2">
<p>&lt;PARCEL ID&gt;</p>
</td>
</tr>
<tr>
<td class="hdlist1">
request_body
</td>
<td class="hdlist2">
<p>{"type" : "receiving", "sched" : "&lt;TIMESTAMP UTC&gt;"}</p>
</td>
</tr>
<tr>
<td class="hdlist1">
expected_result
</td>
<td class="hdlist2">
<p>202 {"success": true}</p>
</td>
</tr>
</table>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Пример запроса/ответа
<br>
Запрос
</td>
<td class="hdlist2">
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell" data-lang="shell">curl -v -X POST "https://sandbox-api.tbt-post.net/api/v1/ev/parcel/sched/f1a7f050-59f7-4d9e-812a-15940e13560c" \
-H "Content-Type: application/json" \
-b cookie-jar.txt \
-d '{"type" : "receiving", "sched" : "1548060981786"}'</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Ответ</dt>
<dd>
<p>HTTP/1.1 202 Accepted<br>
Server: nginx/1.10.3<br>
Date: Mon, 21 Jan 2019 14:36:34 GMT<br>
Content-Type: application/json; charset=utf-8<br>
Content-Length: 17<br>
Connection: keep-alive<br>
Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS<br>
Access-Control-Max-Age: 600<br>
Access-Control-Allow-Credentials: true<br>
Access-Control-Allow-Origin: <a href="https://sandbox-ui.tbt-post.net" class="bare">https://sandbox-ui.tbt-post.net</a><br>
Access-Control-Allow-Headers: Content-Type<br></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json" data-lang="json">{
  "success": true
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Требует авторизации. Применимо для запроса на продление срока хранения собственного отправления.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.3.2<br>
Last updated 2019-08-08 18:40:42 EEST
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.9.1/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>